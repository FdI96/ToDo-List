(()=>{"use strict";const t=class{constructor(t,e,n,r,l){if(this.title=t,this.description=e,this.date=n,this.priority=r,l)this.id=l;else{let t=localStorage.getItem("accToDo");t=Number(t),t+=1,this.id=t,localStorage.setItem("accToDo",t)}}removeElement(){const t=JSON.parse(localStorage.getItem("Default")),e=JSON.parse(localStorage.getItem("currentArray")),n=t=>t.id===this.id,r=t.findIndex(n),l=e.findIndex(n);t.splice(r,1),localStorage.setItem("Default",JSON.stringify(t)),e.splice(l,1);const o=localStorage.getItem("currentProject");localStorage.setItem(o,JSON.stringify(e)),localStorage.setItem("currentArray",e);const i=document.getElementById(`${this.id}`);document.getElementById("toDoListShow").removeChild(i)}print(){const t=document.createElement("div");let e=null;e="low"===this.priority?"primary":"medium"===this.priority?"warning":"danger",t.setAttribute("class",`card text-white bg-${e}`),t.setAttribute("id",`${this.id}`);const n=document.createElement("div");n.setAttribute("class","card-header text-white"),n.innerHTML=this.title,t.appendChild(n);const r=document.createElement("div");r.setAttribute("class","card-body text-white"),t.appendChild(r);const l=document.createElement("h5");l.setAttribute("class","card-title text-white"),l.innerHTML=this.description,r.appendChild(l);let o=document.createElement("p");o.setAttribute("class","card-text text-white"),o.innerHTML=this.date,r.appendChild(o),o=document.createElement("p"),o.setAttribute("class","card-text text-white"),o.innerHTML=this.priority,r.appendChild(o);const i=document.createElement("div");i.setAttribute("class","row container"),t.appendChild(i);const c=document.createElement("button");return c.setAttribute("id","deleteButton"),c.setAttribute("class","col-2"),c.innerHTML="Delete",i.appendChild(c),c.addEventListener("click",(()=>this.removeElement())),t}};let e=JSON.parse(localStorage.getItem("projectsArray"));e=e||["Default"],localStorage.setItem("projectsArray",e);let n=localStorage.getItem("currentProject");n??=localStorage.setItem("currentProject","Default");let r=JSON.parse(localStorage.getItem("Default"));r??=[];let l=JSON.parse(localStorage.getItem("allToDosArray"));l??=[],localStorage.setItem("allToDosArray",JSON.stringify(l)),null==localStorage.getItem("accToDo")&&localStorage.setItem("accToDo",0);let o=localStorage.getItem("currentProject");o??=localStorage.setItem("currentProject","Default"),null==JSON.parse(localStorage.getItem("Default"))&&localStorage.setItem("Default","[]");let i=JSON.parse(localStorage.getItem("Default"));i??=[],localStorage.setItem("currentArray",JSON.stringify(i));const c=document.getElementById("content"),a=document.createElement("div");a.setAttribute("class","col-4"),a.setAttribute("id","projectList"),c.appendChild(a);const d=document.createElement("div");d.setAttribute("class","col-8"),d.setAttribute("id","toDoList"),c.appendChild(d);const s=(()=>{const l=document.getElementById("projectList"),o=document.createElement("div");o.setAttribute("class","row");const i=document.createElement("h1");i.setAttribute("class","col-8"),i.innerHTML="Projects",o.appendChild(i);const c=(()=>{const t=document.createElement("form");t.setAttribute("id","idForm");const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("placeholder","Project name"),e.setAttribute("id","nameField"),t.appendChild(e);const n=document.createElement("span");n.setAttribute("class","col-4");const r=document.createElement("button");return r.setAttribute("type","submit"),r.setAttribute("id","buttonSubmit"),r.innerHTML="Add project",n.appendChild(r),t.appendChild(n),t})();o.appendChild(c);const a=document.createElement("ul");for(let l=0;l<e.length;l+=1){const o=document.createElement("li"),i=document.createElement("button");i.innerHTML=e[l],i.addEventListener("click",(e=>{localStorage.setItem("currentProject",e.target.innerHTML);const n=e.target.innerHTML,r=localStorage.getItem(n),l=JSON.parse(`${r}`);localStorage.setItem("currentArray",JSON.stringify(l));const o=document.getElementById("toDoListShow");o.innerHTML=null;const i="Default"===localStorage.getItem("currentProject")?JSON.parse(localStorage.getItem("Default")):JSON.parse(localStorage.getItem("currentArray"));for(let e=0;e<i.length;e+=1){const n=new t(i[e].title,i[e].description,i[e].date,i[e].priority,i[e].id);if(n.id){const t=n.print();o.appendChild(t),document.getElementById("toDoList").appendChild(o)}}})),o.appendChild(i),a.appendChild(o),r=JSON.parse(localStorage.getItem(n))}return l.appendChild(o),l.appendChild(a),c.children[1].children[0].addEventListener("click",(()=>{e.push(c.children[0].value);const n=document.createElement("li"),l=document.createElement("button");l.innerHTML=c.children[0].value,l.addEventListener("click",(e=>{localStorage.setItem("currentProject",e.target.innerHTML);const n=localStorage.getItem("currentProject");r=JSON.parse(localStorage.getItem(n)),localStorage.setItem("currentArray",JSON.stringify(r)),document.getElementById("toDoListShow").innerHTML=null;for(let e=0;e<r.length;e+=1){const n=new t(r[e].title,r[e].description,r[e].date,r[e].priority,r[e].id);if(n.id){const t=n.print();document.getElementById("toDoListShow").appendChild(t)}}})),localStorage.setItem("currentProject",c.children[0].value);const o=c.children[0].value;localStorage.setItem(`${o}`,JSON.stringify([])),localStorage.setItem("currentArray","[]"),document.getElementById("toDoListShow").innerHTML=null,n.appendChild(l),a.appendChild(n),localStorage.setItem("projectsArray",JSON.stringify(e))})),l})();c.appendChild(s);const u=(()=>{const e=document.getElementById("toDoList"),n=document.createElement("h2");n.setAttribute("class","text-center"),n.innerHTML="List of ToDo",e.appendChild(n);const r=document.createElement("div");r.setAttribute("class","toDoListBlock"),r.appendChild((()=>{const t=document.createElement("form"),e=document.createElement("div");t.appendChild(e);let n=document.createElement("label");n.setAttribute("for","title"),n.innerHTML="Title:",e.appendChild(n);let r=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("name","title"),r.setAttribute("id","title"),e.appendChild(r);const l=document.createElement("div");t.appendChild(l),n=document.createElement("label"),n.innerHTML="Description:",n.setAttribute("for","description"),l.appendChild(n),r=document.createElement("input"),r.setAttribute("type","text"),r.setAttribute("name","description"),r.setAttribute("id","description"),l.appendChild(r);const o=document.createElement("div");t.appendChild(o),n=document.createElement("label"),n.innerHTML="Due Date: ",n.setAttribute("for","dueDate"),o.appendChild(n),r=document.createElement("input"),r.setAttribute("type","date"),r.setAttribute("name","dueDate"),r.setAttribute("id","dueDate"),o.appendChild(r);const i=document.createElement("div");t.appendChild(i),n=document.createElement("label"),n.innerHTML="Priority:",n.setAttribute("for","priority"),i.appendChild(n);for(let t=0;t<3;t+=1){let e;switch(r=document.createElement("input"),t){case 0:e="low";break;case 1:e="medium";break;case 2:e="urgent"}n=document.createElement("label"),n.setAttribute("for",e),n.innerHTML=e,i.appendChild(n),r.setAttribute("type","radio"),r.setAttribute("name",e),r.setAttribute("id",e),i.appendChild(r)}const c=document.createElement("input");return t.appendChild(c),c.setAttribute("type","submit"),c.setAttribute("id","submitButton"),t})()),e.appendChild(r);const l=document.createElement("div");l.setAttribute("id","toDoListShow"),e.appendChild(l);const o=localStorage.getItem("currentProject"),i="Default"===o?JSON.parse(localStorage.getItem("Default")):JSON.parse(localStorage.getItem(o));for(let e=0;e<i.length;e+=1){const n=new t(i[e].title,i[e].description,i[e].date,i[e].priority,i[e].id);if(n.id){const t=n.print();l.appendChild(t)}}return e})();c.appendChild(u),document.getElementById("submitButton").addEventListener("click",(e=>{e.preventDefault();const n=document.getElementById("title").value,r=document.getElementById("description").value,c=document.getElementById("dueDate").value,a=(()=>{const t=document.getElementById("low"),e=document.getElementById("medium"),n=document.getElementById("urgent");let r=null;return r=t.checked?t.name:e.checked?e.name:n.name,r})(),d=new t(n,r,c,a),s=document.getElementById("toDoListShow");s.appendChild(d.print()),l.push(d),i=JSON.parse(localStorage.getItem("currentArray")),localStorage.setItem("Default",JSON.stringify(l)),i.push(d),o=localStorage.getItem("currentProject"),localStorage.setItem("currentArray",JSON.stringify(i)),localStorage.setItem(`${o}`,JSON.stringify(i)),localStorage.setItem("allToDosArray",JSON.stringify(l)),u.appendChild(s)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYWRkQnV0dG9uLmpzIiwid2VicGFjazovLy8uL3NyYy90b0RvLmpzIiwid2VicGFjazovLy8uL3NyYy9wcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RvRG9Db2xsZWN0aW9uLmpzIl0sIm5hbWVzIjpbInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkYXRlIiwicHJpb3JpdHkiLCJpZCIsInRoaXMiLCJhY2MiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiTnVtYmVyIiwic2V0SXRlbSIsImFycmF5RGVmYXVsdCIsIkpTT04iLCJwYXJzZSIsImN1cnJlbnRBcnJheSIsImZpbmRCeUlkIiwiZWxlbWVudCIsImluZGV4RGVmYXVsdCIsImZpbmRJbmRleCIsImluZGV4Q0EiLCJzcGxpY2UiLCJzdHJpbmdpZnkiLCJjdXJyZW50UHJvamVjdCIsImNhcmRUb1JlbW92ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW1vdmVDaGlsZCIsImNhcmQiLCJjcmVhdGVFbGVtZW50IiwiY29sb3IiLCJzZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImJvZHkiLCJib2R5VGl0bGUiLCJib2R5UCIsImtleXBhZCIsImRlbEJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFbGVtZW50IiwicHJvamVjdHMiLCJjdXJyZW50UCIsImFycmF5Q3VycmVudCIsImFsbFRvRG9zIiwiY29udGVudCIsInB0TGlzdCIsInRvTGlzdCIsInByb2plY3RMaXN0IiwiZGl2UHJvamVjdHNCdXR0b24iLCJmb3JtIiwiaW5wdXROYW1lIiwic3BhbkFkZEJ1dHRvbiIsImFkZEJ1dHRvbiIsInVMaXN0IiwiaW5kZXgiLCJsZW5ndGgiLCJsaSIsImJ1dHRvbiIsImUiLCJ0YXJnZXQiLCJ0YXJnZXRWYWx1ZSIsImdldFZhbHVlIiwibGlzdCIsImFycmF5QXV4IiwicmVuZGVyQ2FyZCIsInByaW50IiwiY2hpbGRyZW4iLCJwdXNoIiwidmFsdWUiLCJpdGVtIiwia2V5IiwidG9Eb0xpc3QiLCJ0b0RvTGlzdEJsb2NrIiwiaW5wdXRUaXRsZU5MYWJlbCIsImxhYmVsIiwiaW5wdXQiLCJpbnB1dERlc2NyaXB0aW9uTkxhYmVsIiwiaW5wdXREdWVEYXRlTkxhYmVsIiwiaW5wdXRQcmlvcml0eU5MYWJlbCIsInN1bWJpdEJ1dHRvbiIsInRvRG9MaXN0U2hvdyIsInByZXZlbnREZWZhdWx0IiwiZGVzYyIsInByaW9yIiwicHJpb3JpdHlMb3ciLCJwcmlvcml0eU1lZGl1bSIsInByaW9yaXR5VXJnZW50IiwiY2hlY2tlZCIsIm5hbWUiLCJnZXRQcmlvcml0eSIsInRvRG8iXSwibWFwcGluZ3MiOiJtQkFBQSxNQ3lGQSxFQXpGQSxNQUNFLFlBQVlBLEVBQU9DLEVBQWFDLEVBQU1DLEVBQVVDLEdBSzlDLEdBSkFDLEtBQUtMLE1BQVFBLEVBQ2JLLEtBQUtKLFlBQWNBLEVBQ25CSSxLQUFLSCxLQUFPQSxFQUNaRyxLQUFLRixTQUFXQSxFQUNaQyxFQUNGQyxLQUFLRCxHQUFLQSxNQUNMLENBQ0wsSUFBSUUsRUFBTUMsYUFBYUMsUUFBUSxXQUMvQkYsRUFBTUcsT0FBT0gsR0FDYkEsR0FBTyxFQUNQRCxLQUFLRCxHQUFLRSxFQUNWQyxhQUFhRyxRQUFRLFVBQVdKLElBSXBDLGdCQUNFLE1BQU1LLEVBQWVDLEtBQUtDLE1BQU1OLGFBQWFDLFFBQVEsWUFDL0NNLEVBQWVGLEtBQUtDLE1BQU1OLGFBQWFDLFFBQVEsaUJBQy9DTyxFQUFZQyxHQUFZQSxFQUFRWixLQUFPQyxLQUFLRCxHQUM1Q2EsRUFBZU4sRUFBYU8sVUFBVUgsR0FDdENJLEVBQVVMLEVBQWFJLFVBQVVILEdBQ3ZDSixFQUFhUyxPQUFPSCxFQUFjLEdBQ2xDVixhQUFhRyxRQUFRLFVBQVdFLEtBQUtTLFVBQVVWLElBRS9DRyxFQUFhTSxPQUFPRCxFQUFTLEdBQzdCLE1BQU1HLEVBQWlCZixhQUFhQyxRQUFRLGtCQUM1Q0Qs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UyxVQUFVUCxJQUNwRFAsYUFBYUcsUUFBUSxHQUFHWSxJQUFrQlYsS0FBS1MsVUFBVVAsSUFDekRQLGFBQWFHLFFBQVEsZ0JBQWlCRSxLQUFLUyxVQUFVc0IsSUFDckQ0QixFQUFTdkMsWUFBWWdELE8iLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGFkZEJ1dHRvbkNvbXBvbmVudCA9ICgpID0+IHtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcbiAgZm9ybS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2lkRm9ybScpO1xuICBjb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICBpbnB1dE5hbWUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKTtcbiAgaW5wdXROYW1lLnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLCAnUHJvamVjdCBuYW1lJyk7XG4gIGlucHV0TmFtZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ25hbWVGaWVsZCcpO1xuICBmb3JtLmFwcGVuZENoaWxkKGlucHV0TmFtZSk7XG4gIGNvbnN0IHNwYW5BZGRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gIHNwYW5BZGRCdXR0b24uc2V0QXR0cmlidXRlKCdjbGFzcycsICdjb2wtNCcpO1xuICBjb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZSgndHlwZScsICdzdWJtaXQnKTtcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZSgnaWQnLCAnYnV0dG9uU3VibWl0Jyk7XG4gIGFkZEJ1dHRvbi5pbm5lckhUTUwgPSAnQWRkIHByb2plY3QnO1xuXG4gIHNwYW5BZGRCdXR0b24uYXBwZW5kQ2hpbGQoYWRkQnV0dG9uKTtcbiAgZm9ybS5hcHBlbmRDaGlsZChzcGFuQWRkQnV0dG9uKTtcblxuICByZXR1cm4gZm9ybTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFkZEJ1dHRvbkNvbXBvbmVudDtcbiIsImNsYXNzIFRvRG8ge1xuICBjb25zdHJ1Y3Rvcih0aXRsZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5LCBpZCkge1xuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgdGhpcy5kYXRlID0gZGF0ZTtcbiAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgaWYgKGlkKSB7XG4gICAgICB0aGlzLmlkID0gaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBhY2MgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImFjY1RvRG9cIik7XG4gICAgICBhY2MgPSBOdW1iZXIoYWNjKTtcbiAgICAgIGFjYyArPSAxO1xuICAgICAgdGhpcy5pZCA9IGFjYztcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWNjVG9Eb1wiLCBhY2MpO1xuICAgIH1cbiAgfVxuXG4gIHJlbW92ZUVsZW1lbnQoKSB7XG4gICAgY29uc3QgYXJyYXlEZWZhdWx0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIkRlZmF1bHRcIikpO1xuICAgIGNvbnN0IGN1cnJlbnRBcnJheSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50QXJyYXlcIikpO1xuICAgIGNvbnN0IGZpbmRCeUlkID0gKGVsZW1lbnQpID0+IGVsZW1lbnQuaWQgPT09IHRoaXMuaWQ7XG4gICAgY29uc3QgaW5kZXhEZWZhdWx0ID0gYXJyYXlEZWZhdWx0LmZpbmRJbmRleChmaW5kQnlJZCk7XG4gICAgY29uc3QgaW5kZXhDQSA9IGN1cnJlbnRBcnJheS5maW5kSW5kZXgoZmluZEJ5SWQpO1xuICAgIGFycmF5RGVmYXVsdC5zcGxpY2UoaW5kZXhEZWZhdWx0LCAxKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIkRlZmF1bHRcIiwgSlNPTi5zdHJpbmdpZnkoYXJyYXlEZWZhdWx0KSk7XG5cbiAgICBjdXJyZW50QXJyYXkuc3BsaWNlKGluZGV4Q0EsIDEpO1xuICAgIGNvbnN0IGN1cnJlbnRQcm9qZWN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjdXJyZW50UHJvamVjdCwgSlNPTi5zdHJpbmdpZnkoY3VycmVudEFycmF5KSk7XG5cbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRBcnJheVwiLCBjdXJyZW50QXJyYXkpO1xuXG4gICAgY29uc3QgY2FyZFRvUmVtb3ZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGhpcy5pZH1gKTtcbiAgICBjb25zdCBzaG93VG9Eb0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvRG9MaXN0U2hvd1wiKTtcbiAgICBzaG93VG9Eb0xpc3QucmVtb3ZlQ2hpbGQoY2FyZFRvUmVtb3ZlKTtcbiAgfVxuXG4gIHByaW50KCkge1xuICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGxldCBjb2xvciA9IG51bGw7XG4gICAgaWYgKHRoaXMucHJpb3JpdHkgPT09IFwibG93XCIpIHtcbiAgICAgIGNvbG9yID0gXCJwcmltYXJ5XCI7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByaW9yaXR5ID09PSBcIm1lZGl1bVwiKSB7XG4gICAgICBjb2xvciA9IFwid2FybmluZ1wiO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2xvciA9IFwiZGFuZ2VyXCI7XG4gICAgfVxuICAgIGNhcmQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgYGNhcmQgdGV4dC13aGl0ZSBiZy0ke2NvbG9yfWApO1xuICAgIGNhcmQuc2V0QXR0cmlidXRlKFwiaWRcIiwgYCR7dGhpcy5pZH1gKTtcblxuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0aXRsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNhcmQtaGVhZGVyIHRleHQtd2hpdGVcIik7XG4gICAgdGl0bGUuaW5uZXJIVE1MID0gdGhpcy50aXRsZTtcbiAgICBjYXJkLmFwcGVuZENoaWxkKHRpdGxlKTtcblxuICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGJvZHkuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjYXJkLWJvZHkgdGV4dC13aGl0ZVwiKTtcbiAgICBjYXJkLmFwcGVuZENoaWxkKGJvZHkpO1xuXG4gICAgY29uc3QgYm9keVRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImg1XCIpO1xuICAgIGJvZHlUaXRsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNhcmQtdGl0bGUgdGV4dC13aGl0ZVwiKTtcbiAgICBib2R5VGl0bGUuaW5uZXJIVE1MID0gdGhpcy5kZXNjcmlwdGlvbjtcbiAgICBib2R5LmFwcGVuZENoaWxkKGJvZHlUaXRsZSk7XG5cbiAgICBsZXQgYm9keVAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICBib2R5UC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNhcmQtdGV4dCB0ZXh0LXdoaXRlXCIpO1xuICAgIGJvZHlQLmlubmVySFRNTCA9IHRoaXMuZGF0ZTtcbiAgICBib2R5LmFwcGVuZENoaWxkKGJvZHlQKTtcblxuICAgIGJvZHlQID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgYm9keVAuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjYXJkLXRleHQgdGV4dC13aGl0ZVwiKTtcbiAgICBib2R5UC5pbm5lckhUTUwgPSB0aGlzLnByaW9yaXR5O1xuICAgIGJvZHkuYXBwZW5kQ2hpbGQoYm9keVApO1xuXG4gICAgY29uc3Qga2V5cGFkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBrZXlwYWQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJyb3cgY29udGFpbmVyXCIpO1xuICAgIGNhcmQuYXBwZW5kQ2hpbGQoa2V5cGFkKTtcblxuICAgIGNvbnN0IGRlbEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZShcImlkXCIsIFwiZGVsZXRlQnV0dG9uXCIpO1xuICAgIGRlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNvbC0yXCIpO1xuICAgIGRlbEJ1dHRvbi5pbm5lckhUTUwgPSBcIkRlbGV0ZVwiO1xuICAgIGtleXBhZC5hcHBlbmRDaGlsZChkZWxCdXR0b24pO1xuICAgIGRlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5yZW1vdmVFbGVtZW50KCkpO1xuXG4gICAgcmV0dXJuIGNhcmQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVG9EbztcbiIsImltcG9ydCBhZGRCdXR0b25Db21wb25lbnQgZnJvbSBcIi4vYWRkQnV0dG9uXCI7XG5pbXBvcnQgVG9EbyBmcm9tIFwiLi90b0RvXCI7XG5cbmxldCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIpKTtcbnByb2plY3RzID0gIXByb2plY3RzID8gW1wiRGVmYXVsdFwiXSA6IHByb2plY3RzO1xubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIsIHByb2plY3RzKTtcblxubGV0IGN1cnJlbnRQID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiKTtcbmN1cnJlbnRQID8/PSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIFwiRGVmYXVsdFwiKTtcblxubGV0IGFycmF5Q3VycmVudCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJEZWZhdWx0XCIpKTtcbmFycmF5Q3VycmVudCA/Pz0gW107XG5cbmNvbnN0IHByb2plY3RMaXN0Q29tcG9uZW50ID0gKCkgPT4ge1xuICBjb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdExpc3RcIik7XG5cbiAgY29uc3QgZGl2UHJvamVjdHNCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBkaXZQcm9qZWN0c0J1dHRvbi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInJvd1wiKTtcblxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMVwiKTtcbiAgdGl0bGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjb2wtOFwiKTtcbiAgdGl0bGUuaW5uZXJIVE1MID0gXCJQcm9qZWN0c1wiO1xuICBkaXZQcm9qZWN0c0J1dHRvbi5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gIGNvbnN0IGZvcm0gPSBhZGRCdXR0b25Db21wb25lbnQoKTtcbiAgZGl2UHJvamVjdHNCdXR0b24uYXBwZW5kQ2hpbGQoZm9ybSk7XG5cbiAgY29uc3QgdUxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidWxcIik7XG5cbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHByb2plY3RzLmxlbmd0aDsgaW5kZXggKz0gMSkge1xuICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgYnV0dG9uLmlubmVySFRNTCA9IHByb2plY3RzW2luZGV4XTtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIGUudGFyZ2V0LmlubmVySFRNTCk7XG4gICAgICBjb25zdCB0YXJnZXRWYWx1ZSA9IGUudGFyZ2V0LmlubmVySFRNTDtcbiAgICAgIGNvbnN0IGdldFZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGFyZ2V0VmFsdWUpO1xuICAgICAgY29uc3QgYXJyYXlDdXJyZW50ID0gSlNPTi5wYXJzZShgJHtnZXRWYWx1ZX1gKTtcblxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50QXJyYXlcIiwgSlNPTi5zdHJpbmdpZnkoYXJyYXlDdXJyZW50KSk7XG4gICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0RvTGlzdFNob3dcIik7XG5cbiAgICAgIGxpc3QuaW5uZXJIVE1MID0gbnVsbDtcbiAgICAgIGNvbnN0IGN1cnJlbnRQID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiKTtcbiAgICAgIGNvbnN0IGFycmF5QXV4ID1cbiAgICAgICAgY3VycmVudFAgPT09IFwiRGVmYXVsdFwiXG4gICAgICAgICAgPyBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiRGVmYXVsdFwiKSlcbiAgICAgICAgICA6IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50QXJyYXlcIikpO1xuXG4gICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgYXJyYXlBdXgubGVuZ3RoOyBpbmRleCArPSAxKSB7XG4gICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgVG9EbyhcbiAgICAgICAgICBhcnJheUF1eFtpbmRleF0udGl0bGUsXG4gICAgICAgICAgYXJyYXlBdXhbaW5kZXhdLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIGFycmF5QXV4W2luZGV4XS5kYXRlLFxuICAgICAgICAgIGFycmF5QXV4W2luZGV4XS5wcmlvcml0eSxcbiAgICAgICAgICBhcnJheUF1eFtpbmRleF0uaWRcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoY2FyZC5pZCkge1xuICAgICAgICAgIGNvbnN0IHJlbmRlckNhcmQgPSBjYXJkLnByaW50KCk7XG4gICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChyZW5kZXJDYXJkKTtcbiAgICAgICAgICBjb25zdCB0b0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvRG9MaXN0XCIpO1xuICAgICAgICAgIHRvTGlzdC5hcHBlbmRDaGlsZChsaXN0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgbGkuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICB1TGlzdC5hcHBlbmRDaGlsZChsaSk7XG5cbiAgICBhcnJheUN1cnJlbnQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGN1cnJlbnRQKSk7XG4gIH1cblxuICBwcm9qZWN0TGlzdC5hcHBlbmRDaGlsZChkaXZQcm9qZWN0c0J1dHRvbik7XG5cbiAgcHJvamVjdExpc3QuYXBwZW5kQ2hpbGQodUxpc3QpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGZvcm0uY2hpbGRyZW5bMV0uY2hpbGRyZW5bMF07XG4gIHN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHByb2plY3RzLnB1c2goZm9ybS5jaGlsZHJlblswXS52YWx1ZSk7XG4gICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICBidXR0b24uaW5uZXJIVE1MID0gZm9ybS5jaGlsZHJlblswXS52YWx1ZTtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIGUudGFyZ2V0LmlubmVySFRNTCk7XG4gICAgICBjb25zdCBpdGVtID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiKTtcbiAgICAgIGFycmF5Q3VycmVudCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oaXRlbSkpO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50QXJyYXlcIiwgSlNPTi5zdHJpbmdpZnkoYXJyYXlDdXJyZW50KSk7XG4gICAgICBjb25zdCB0b0RvTCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9Eb0xpc3RTaG93XCIpO1xuICAgICAgdG9Eb0wuaW5uZXJIVE1MID0gbnVsbDtcbiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhcnJheUN1cnJlbnQubGVuZ3RoOyBpbmRleCArPSAxKSB7XG4gICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgVG9EbyhcbiAgICAgICAgICBhcnJheUN1cnJlbnRbaW5kZXhdLnRpdGxlLFxuICAgICAgICAgIGFycmF5Q3VycmVudFtpbmRleF0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgYXJyYXlDdXJyZW50W2luZGV4XS5kYXRlLFxuICAgICAgICAgIGFycmF5Q3VycmVudFtpbmRleF0ucHJpb3JpdHksXG4gICAgICAgICAgYXJyYXlDdXJyZW50W2luZGV4XS5pZFxuICAgICAgICApO1xuICAgICAgICBpZiAoY2FyZC5pZCkge1xuICAgICAgICAgIGNvbnN0IHJlbmRlckNhcmQgPSBjYXJkLnByaW50KCk7XG4gICAgICAgICAgY29uc3QgdG9Eb0xpc3RTaG93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0RvTGlzdFNob3dcIik7XG4gICAgICAgICAgdG9Eb0xpc3RTaG93LmFwcGVuZENoaWxkKHJlbmRlckNhcmQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiLCBmb3JtLmNoaWxkcmVuWzBdLnZhbHVlKTtcbiAgICBjb25zdCBrZXkgPSBmb3JtLmNoaWxkcmVuWzBdLnZhbHVlO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGAke2tleX1gLCBKU09OLnN0cmluZ2lmeShbXSkpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudEFycmF5XCIsIFwiW11cIik7XG4gICAgY29uc3QgdG9Eb0xpc3RTaG93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0RvTGlzdFNob3dcIik7XG4gICAgdG9Eb0xpc3RTaG93LmlubmVySFRNTCA9IG51bGw7XG4gICAgbGkuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICB1TGlzdC5hcHBlbmRDaGlsZChsaSk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RzKSk7XG4gIH0pO1xuXG4gIHJldHVybiBwcm9qZWN0TGlzdDtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHByb2plY3RMaXN0Q29tcG9uZW50O1xuIiwiaW1wb3J0IHByb2plY3RMaXN0Q29tcG9uZW50IGZyb20gJy4vcHJvamVjdHMnO1xuaW1wb3J0IHRvRG9Db2xsZWN0aW9uIGZyb20gJy4vdG9Eb0NvbGxlY3Rpb24nO1xuaW1wb3J0IFRvRG8gZnJvbSAnLi90b0RvJztcblxubGV0IGFsbFRvRG9zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWxsVG9Eb3NBcnJheScpKTtcbmFsbFRvRG9zID8/PSBbXTtcbmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhbGxUb0Rvc0FycmF5JywgSlNPTi5zdHJpbmdpZnkoYWxsVG9Eb3MpKTtcblxuY29uc3QgY3VycmVudEFjYyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2NUb0RvJyk7XG5pZiAoY3VycmVudEFjYyA9PSBudWxsKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY2NUb0RvJywgMCk7XG59XG5sZXQgY3VycmVudFByb2plY3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudFByb2plY3QnKTtcbmN1cnJlbnRQcm9qZWN0ID8/PSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY3VycmVudFByb2plY3QnLCAnRGVmYXVsdCcpO1xuY29uc3QgZGVmUHJvamVjdCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0RlZmF1bHQnKSk7XG5pZiAoZGVmUHJvamVjdCA9PSBudWxsKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdEZWZhdWx0JywgJ1tdJyk7XG59XG5cbmxldCBjdXJyZW50QXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdEZWZhdWx0JykpO1xuY3VycmVudEFycmF5ID8/PSBbXTtcbmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjdXJyZW50QXJyYXknLCBKU09OLnN0cmluZ2lmeShjdXJyZW50QXJyYXkpKTtcblxuY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250ZW50Jyk7XG5cbmNvbnN0IHB0TGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG5wdExpc3Quc2V0QXR0cmlidXRlKCdjbGFzcycsICdjb2wtNCcpO1xucHRMaXN0LnNldEF0dHJpYnV0ZSgnaWQnLCAncHJvamVjdExpc3QnKTtcbmNvbnRlbnQuYXBwZW5kQ2hpbGQocHRMaXN0KTtcblxuY29uc3QgdG9MaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG50b0xpc3Quc2V0QXR0cmlidXRlKCdjbGFzcycsICdjb2wtOCcpO1xudG9MaXN0LnNldEF0dHJpYnV0ZSgnaWQnLCAndG9Eb0xpc3QnKTtcbmNvbnRlbnQuYXBwZW5kQ2hpbGQodG9MaXN0KTtcblxuY29uc3QgcHJvamVjdExpc3QgPSBwcm9qZWN0TGlzdENvbXBvbmVudCgpO1xuXG5jb250ZW50LmFwcGVuZENoaWxkKHByb2plY3RMaXN0KTtcblxuY29uc3QgdG9Eb0xpc3QgPSB0b0RvQ29sbGVjdGlvbigpO1xuY29udGVudC5hcHBlbmRDaGlsZCh0b0RvTGlzdCk7XG5cbmNvbnN0IGdldFRpdGxlID0gKCkgPT4ge1xuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aXRsZScpO1xuICByZXR1cm4gdGl0bGUudmFsdWU7XG59O1xuXG5jb25zdCBnZXREZXNjcmlwdGlvbiA9ICgpID0+IHtcbiAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKTtcbiAgcmV0dXJuIGRlc2NyaXB0aW9uLnZhbHVlO1xufTtcblxuY29uc3QgZ2V0RGF0ZSA9ICgpID0+IHtcbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkdWVEYXRlJyk7XG4gIHJldHVybiBkYXRlLnZhbHVlO1xufTtcblxuY29uc3QgZ2V0UHJpb3JpdHkgPSAoKSA9PiB7XG4gIGNvbnN0IHByaW9yaXR5TG93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvdycpO1xuICBjb25zdCBwcmlvcml0eU1lZGl1bSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZWRpdW0nKTtcbiAgY29uc3QgcHJpb3JpdHlVcmdlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXJnZW50Jyk7XG4gIGxldCBwcmlvcml0eSA9IG51bGw7XG4gIGlmIChwcmlvcml0eUxvdy5jaGVja2VkKSB7XG4gICAgcHJpb3JpdHkgPSBwcmlvcml0eUxvdy5uYW1lO1xuICB9IGVsc2UgaWYgKHByaW9yaXR5TWVkaXVtLmNoZWNrZWQpIHtcbiAgICBwcmlvcml0eSA9IHByaW9yaXR5TWVkaXVtLm5hbWU7XG4gIH0gZWxzZSB7XG4gICAgcHJpb3JpdHkgPSBwcmlvcml0eVVyZ2VudC5uYW1lO1xuICB9XG4gIHJldHVybiBwcmlvcml0eTtcbn07XG5cbmNvbnN0IG9uU3VibWl0Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdWJtaXRCdXR0b24nKTtcbm9uU3VibWl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgdGl0bGUgPSBnZXRUaXRsZSgpO1xuICBjb25zdCBkZXNjID0gZ2V0RGVzY3JpcHRpb24oKTtcbiAgY29uc3QgZGF0ZSA9IGdldERhdGUoKTtcbiAgY29uc3QgcHJpb3IgPSBnZXRQcmlvcml0eSgpO1xuXG4gIGNvbnN0IHRvRG8gPSBuZXcgVG9Ebyh0aXRsZSwgZGVzYywgZGF0ZSwgcHJpb3IpO1xuICBjb25zdCB0b0RvTGlzdFNob3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9Eb0xpc3RTaG93Jyk7XG4gIHRvRG9MaXN0U2hvdy5hcHBlbmRDaGlsZCh0b0RvLnByaW50KCkpO1xuICBhbGxUb0Rvcy5wdXNoKHRvRG8pO1xuICBjdXJyZW50QXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50QXJyYXknKSk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdEZWZhdWx0JywgSlNPTi5zdHJpbmdpZnkoYWxsVG9Eb3MpKTtcbiAgY3VycmVudEFycmF5LnB1c2godG9Ebyk7XG4gIGN1cnJlbnRQcm9qZWN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRQcm9qZWN0Jyk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjdXJyZW50QXJyYXknLCBKU09OLnN0cmluZ2lmeShjdXJyZW50QXJyYXkpKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7Y3VycmVudFByb2plY3R9YCwgSlNPTi5zdHJpbmdpZnkoY3VycmVudEFycmF5KSk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhbGxUb0Rvc0FycmF5JywgSlNPTi5zdHJpbmdpZnkoYWxsVG9Eb3MpKTtcbiAgdG9Eb0xpc3QuYXBwZW5kQ2hpbGQodG9Eb0xpc3RTaG93KTtcbn0pO1xuIiwiaW1wb3J0IFRvRG8gZnJvbSAnLi90b0RvJztcblxuY29uc3QgZm9ybSA9ICgpID0+IHtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcbiAgY29uc3QgaW5wdXRUaXRsZU5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBmb3JtLmFwcGVuZENoaWxkKGlucHV0VGl0bGVOTGFiZWwpO1xuICBsZXQgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICd0aXRsZScpO1xuICBsYWJlbC5pbm5lckhUTUwgPSAnVGl0bGU6JztcbiAgaW5wdXRUaXRsZU5MYWJlbC5hcHBlbmRDaGlsZChsYWJlbCk7XG5cbiAgbGV0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgaW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKTtcbiAgaW5wdXQuc2V0QXR0cmlidXRlKCduYW1lJywgJ3RpdGxlJyk7XG4gIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCAndGl0bGUnKTtcbiAgaW5wdXRUaXRsZU5MYWJlbC5hcHBlbmRDaGlsZChpbnB1dCk7XG5cbiAgY29uc3QgaW5wdXREZXNjcmlwdGlvbk5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBmb3JtLmFwcGVuZENoaWxkKGlucHV0RGVzY3JpcHRpb25OTGFiZWwpO1xuICBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG4gIGxhYmVsLmlubmVySFRNTCA9ICdEZXNjcmlwdGlvbjonO1xuICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdkZXNjcmlwdGlvbicpO1xuICBpbnB1dERlc2NyaXB0aW9uTkxhYmVsLmFwcGVuZENoaWxkKGxhYmVsKTtcblxuICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gIGlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0Jyk7XG4gIGlucHV0LnNldEF0dHJpYnV0ZSgnbmFtZScsICdkZXNjcmlwdGlvbicpO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2Rlc2NyaXB0aW9uJyk7XG4gIGlucHV0RGVzY3JpcHRpb25OTGFiZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuXG4gIGNvbnN0IGlucHV0RHVlRGF0ZU5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBmb3JtLmFwcGVuZENoaWxkKGlucHV0RHVlRGF0ZU5MYWJlbCk7XG4gIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgbGFiZWwuaW5uZXJIVE1MID0gJ0R1ZSBEYXRlOiAnO1xuICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdkdWVEYXRlJyk7XG4gIGlucHV0RHVlRGF0ZU5MYWJlbC5hcHBlbmRDaGlsZChsYWJlbCk7XG5cbiAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnZGF0ZScpO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnZHVlRGF0ZScpO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2R1ZURhdGUnKTtcbiAgaW5wdXREdWVEYXRlTkxhYmVsLmFwcGVuZENoaWxkKGlucHV0KTtcblxuICBjb25zdCBpbnB1dFByaW9yaXR5TkxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXRQcmlvcml0eU5MYWJlbCk7XG4gIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcbiAgbGFiZWwuaW5uZXJIVE1MID0gJ1ByaW9yaXR5Oic7XG4gIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3ByaW9yaXR5Jyk7XG4gIGlucHV0UHJpb3JpdHlOTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xuXG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCAzOyBpbmRleCArPSAxKSB7XG4gICAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGxldCBwcmlvcml0eTtcbiAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIHByaW9yaXR5ID0gJ2xvdyc7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIDE6XG4gICAgICAgIHByaW9yaXR5ID0gJ21lZGl1bSc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBwcmlvcml0eSA9ICd1cmdlbnQnO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICAgIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgcHJpb3JpdHkpO1xuICAgIGxhYmVsLmlubmVySFRNTCA9IHByaW9yaXR5O1xuICAgIGlucHV0UHJpb3JpdHlOTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICdyYWRpbycpO1xuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnbmFtZScsIHByaW9yaXR5KTtcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2lkJywgcHJpb3JpdHkpO1xuICAgIGlucHV0UHJpb3JpdHlOTGFiZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuICB9XG5cbiAgY29uc3Qgc3VtYml0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgZm9ybS5hcHBlbmRDaGlsZChzdW1iaXRCdXR0b24pO1xuICBzdW1iaXRCdXR0b24uc2V0QXR0cmlidXRlKCd0eXBlJywgJ3N1Ym1pdCcpO1xuICBzdW1iaXRCdXR0b24uc2V0QXR0cmlidXRlKCdpZCcsICdzdWJtaXRCdXR0b24nKTtcbiAgcmV0dXJuIGZvcm07XG59O1xuXG5jb25zdCB0b0RvQ29sbGVjdGlvbiA9ICgpID0+IHtcbiAgY29uc3QgdG9Eb0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9Eb0xpc3QnKTtcblxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XG4gIHRpdGxlLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAndGV4dC1jZW50ZXInKTtcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ0xpc3Qgb2YgVG9Ebyc7XG5cbiAgdG9Eb0xpc3QuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG4gIGNvbnN0IHRvRG9MaXN0QmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgdG9Eb0xpc3RCbG9jay5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3RvRG9MaXN0QmxvY2snKTtcblxuICB0b0RvTGlzdEJsb2NrLmFwcGVuZENoaWxkKGZvcm0oKSk7XG4gIHRvRG9MaXN0LmFwcGVuZENoaWxkKHRvRG9MaXN0QmxvY2spO1xuXG4gIGNvbnN0IHRvRG9MaXN0U2hvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB0b0RvTGlzdFNob3cuc2V0QXR0cmlidXRlKCdpZCcsICd0b0RvTGlzdFNob3cnKTtcbiAgdG9Eb0xpc3QuYXBwZW5kQ2hpbGQodG9Eb0xpc3RTaG93KTtcbiAgY29uc3QgY3VycmVudFByb2plY3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudFByb2plY3QnKTtcbiAgY29uc3QgYXJyYXlBdXggPSBjdXJyZW50UHJvamVjdCA9PT0gJ0RlZmF1bHQnXG4gICAgPyBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdEZWZhdWx0JykpXG4gICAgOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGN1cnJlbnRQcm9qZWN0KSk7XG5cbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGFycmF5QXV4Lmxlbmd0aDsgaW5kZXggKz0gMSkge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgVG9EbyhcbiAgICAgIGFycmF5QXV4W2luZGV4XS50aXRsZSxcbiAgICAgIGFycmF5QXV4W2luZGV4XS5kZXNjcmlwdGlvbixcbiAgICAgIGFycmF5QXV4W2luZGV4XS5kYXRlLFxuICAgICAgYXJyYXlBdXhbaW5kZXhdLnByaW9yaXR5LFxuICAgICAgYXJyYXlBdXhbaW5kZXhdLmlkLFxuICAgICk7XG4gICAgaWYgKGNhcmQuaWQpIHtcbiAgICAgIGNvbnN0IHJlbmRlckNhcmQgPSBjYXJkLnByaW50KCk7XG4gICAgICB0b0RvTGlzdFNob3cuYXBwZW5kQ2hpbGQocmVuZGVyQ2FyZCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRvRG9MaXN0O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgdG9Eb0NvbGxlY3Rpb247XG4iXSwic291cmNlUm9vdCI6IiJ9