(()=>{"use strict";const e=window.localStorage;let t=JSON.parse(e.getItem("projectsArray"));t=t||["Default"];class r{constructor(e,t,r,n){this.title=e,this.description=t,this.date=r,this.priority=n;let l=localStorage.getItem("accToDo");this.id=l++,localStorage.setItem("accToDo",l)}removeElement(){let e=JSON.parse(localStorage.getItem("Default")),t=JSON.parse(localStorage.getItem("currentArray")),r=e=>e.id==this.id,n=e.findIndex(r),l=t.findIndex(r);e.splice(n,1),localStorage.setItem("Default",JSON.stringify(e)),t.splice(l,1);let i=localStorage.getItem("currentProject");localStorage.setItem(i,JSON.stringify(t));let a=document.getElementById(`${this.id}`);document.getElementById("toDoListShow").removeChild(a)}print(){let e=document.createElement("div"),t=null;t="low"==this.priority?"primary":"medium"==this.priority?"warning":"danger",e.setAttribute("class",`card text-white bg-${t}`),e.setAttribute("id",`${this.id}`);let r=document.createElement("div");r.setAttribute("class","card-header text-white"),r.innerHTML=this.title,e.appendChild(r);let n=document.createElement("div");n.setAttribute("class","card-body text-white"),e.appendChild(n);let l=document.createElement("h5");l.setAttribute("class","card-title text-white"),l.innerHTML=this.description,n.appendChild(l);let i=document.createElement("p");i.setAttribute("class","card-text text-white"),i.innerHTML=this.date,n.appendChild(i),i=document.createElement("p"),i.setAttribute("class","card-text text-white"),i.innerHTML=this.priority,n.appendChild(i);const a=document.createElement("div");a.setAttribute("class","row container"),e.appendChild(a);const o=document.createElement("button");return o.setAttribute("id","deleteButton"),o.setAttribute("class","col-2"),o.innerHTML="Delete",a.appendChild(o),o.addEventListener("click",(()=>this.removeElement())),e}}let n=localStorage.getItem("currentProject");n??=localStorage.setItem("currentProject","Default");let l=JSON.parse(localStorage.getItem("allToDosArray"));l??=[];let i=JSON.parse(localStorage.getItem("projectsArray"));i??=[];let a=JSON.parse(localStorage.getItem("Default"));a??=[];let o=JSON.parse(localStorage.getItem("allToDosArray"));o??=[];let c=localStorage.getItem("accToDo");c??=localStorage.setItem("accToDo",0);let d=localStorage.getItem("currentProject");d??=localStorage.setItem("currentProject","Default"),null==JSON.parse(localStorage.getItem("Default"))&&localStorage.setItem("Default","[]");let s=JSON.parse(localStorage.getItem("Default"));s??=[],localStorage.setItem("currentArray",JSON.stringify(s));const u=document.getElementById("content"),m=document.createElement("div");m.setAttribute("class","col-4"),m.setAttribute("id","projectList"),u.appendChild(m);const p=document.createElement("div");p.setAttribute("class","col-8"),p.setAttribute("id","toDoList"),u.appendChild(p);let g=(()=>{const e=document.getElementById("projectList"),i=document.createElement("div");i.setAttribute("class","row");const o=document.createElement("h1");o.setAttribute("class","col-8"),o.innerHTML="Projects",i.appendChild(o);const c=(()=>{const e=document.createElement("form");e.setAttribute("id","idForm");const t=document.createElement("input");t.setAttribute("type","text"),t.setAttribute("placeholder","Project name"),t.setAttribute("id","nameField"),e.appendChild(t);const r=document.createElement("span");r.setAttribute("class","col-4");const n=document.createElement("button");return n.setAttribute("type","submit"),n.setAttribute("id","buttonSubmit"),n.innerHTML="Add project",r.appendChild(n),e.appendChild(r),e})();i.appendChild(c);const d=document.createElement("ul");for(let e=0;e<t.length;e++){let i=document.createElement("li"),o=document.createElement("button");o.innerHTML=t[e],o.addEventListener("click",(e=>{localStorage.setItem("currentProject",e.target.innerHTML),a=JSON.parse(localStorage.getItem(e.target.innerHTML)),localStorage.setItem("currentArray",JSON.stringify(a));let t=document.getElementById("toDoListShow");t.innerHTML=null;const n="Default"==localStorage.getItem("currentProject")?l:JSON.parse(localStorage.getItem("currentArray"));for(let e=0;e<n.length;e++){let l=new r(n[e].title,n[e].description,n[e].date,n[e].priority);if(l.title){let e=l.print();t.appendChild(e),toDoList.appendChild(t)}}})),i.appendChild(o),d.appendChild(i),a=JSON.parse(localStorage.getItem(n))}return e.appendChild(i),e.appendChild(d),c.children[1].children[0].addEventListener("click",(e=>{t.push(c.children[0].value);let n=document.createElement("li"),l=document.createElement("button");l.innerHTML=c.children[0].value,l.addEventListener("click",(e=>{localStorage.setItem("currentProject",e.target.innerHTML);let t=localStorage.getItem("currentProject");a=JSON.parse(localStorage.getItem(t)),localStorage.setItem("currentArray",JSON.stringify(a)),getElementById("toDoListShow").innerHTML=null;for(let e=0;e<a.length;e++){const t=new r(a[e].title,a[e].description,a[e].date,a[e].priority);if(t.id){let e=t.print();o.appendChild(e)}}})),localStorage.setItem("currentProject",c.children[0].value);let i=c.children[0].value;localStorage.setItem(`${i}`,JSON.stringify([])),localStorage.setItem("currentArray","[]");let o=document.getElementById("toDoListShow");o.innerHTML=null,n.appendChild(l),d.appendChild(n),localStorage.setItem("projectsArray",JSON.stringify(t))})),e})();u.appendChild(g);const h=(()=>{const e=document.getElementById("toDoList"),t=document.createElement("h2");t.setAttribute("class","text-center"),t.innerHTML="List of ToDo",e.appendChild(t);const n=document.createElement("div");n.setAttribute("class","toDoListBlock"),n.appendChild((()=>{const e=document.createElement("form"),t=document.createElement("div");e.appendChild(t);let r=document.createElement("label");r.setAttribute("for","title"),r.innerHTML="Title:",t.appendChild(r);let n=document.createElement("input");n.setAttribute("type","text"),n.setAttribute("name","title"),n.setAttribute("id","title"),t.appendChild(n);const l=document.createElement("div");e.appendChild(l),r=document.createElement("label"),r.innerHTML="Description:",r.setAttribute("for","description"),l.appendChild(r),n=document.createElement("input"),n.setAttribute("type","text"),n.setAttribute("name","description"),n.setAttribute("id","description"),l.appendChild(n);const i=document.createElement("div");e.appendChild(i),r=document.createElement("label"),r.innerHTML="Due Date: ",r.setAttribute("for","dueDate"),i.appendChild(r),n=document.createElement("input"),n.setAttribute("type","date"),n.setAttribute("name","dueDate"),n.setAttribute("id","dueDate"),i.appendChild(n);const a=document.createElement("div");e.appendChild(a),r=document.createElement("label"),r.innerHTML="Priority:",r.setAttribute("for","priority"),a.appendChild(r);for(let e=0;e<3;e++){let t;switch(n=document.createElement("input"),e){case 0:t="low";break;case 1:t="medium";break;case 2:t="urgent"}r=document.createElement("label"),r.setAttribute("for",t),r.innerHTML=t,a.appendChild(r),n.setAttribute("type","radio"),n.setAttribute("name",t),n.setAttribute("id",t),a.appendChild(n)}const o=document.createElement("input");return e.appendChild(o),o.setAttribute("type","submit"),o.setAttribute("id","submitButton"),e})()),e.appendChild(n);const l=document.createElement("div");l.setAttribute("id","toDoListShow"),e.appendChild(l);let i=localStorage.getItem("currentProject");const a="Default"==i?o:JSON.parse(localStorage.getItem(i));for(let e=0;e<a.length;e++){const t=new r(a[e].title,a[e].description,a[e].date,a[e].priority);if(t.title){let e=t.print();l.appendChild(e)}}return e})();u.appendChild(h),document.getElementById("submitButton").addEventListener("click",(e=>{e.preventDefault();let t=document.getElementById("title").value,n=document.getElementById("description").value,l=document.getElementById("dueDate").value,i=(()=>{let e=document.getElementById("low"),t=document.getElementById("medium"),r=document.getElementById("urgent"),n=null;return n=e.checked?e.name:t.checked?t.name:r.name,n})(),a=new r(t,n,l,i);toDoListShow.appendChild(a.print()),o.push(a),s=JSON.parse(localStorage.getItem("currentArray")),localStorage.setItem("Default",JSON.stringify(o)),s.push(a),d=localStorage.getItem("currentProject"),localStorage.setItem("currentArray",JSON.stringify(s)),localStorage.setItem(`${d}`,JSON.stringify(s)),localStorage.setItem("allToDosArray",JSON.stringify(o)),h.appendChild(toDoListShow)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYWRkQnV0dG9uLmpzIiwid2VicGFjazovLy8uL3NyYy90b0RvLmpzIiwid2VicGFjazovLy8uL3NyYy9wcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdG9Eb0NvbGxlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbIm15U3RvcmFnZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInByb2plY3RzIiwiSlNPTiIsInBhcnNlIiwiZ2V0SXRlbSIsIlRvRG8iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiZGF0ZSIsInByaW9yaXR5IiwidGhpcyIsImFjYyIsImlkIiwic2V0SXRlbSIsImFycmF5RGVmYXVsdCIsImN1cnJlbnRBcnJheSIsImZpbmRCeUlkIiwiZWxlbWVudCIsImluZGV4RGVmYXVsdCIsImZpbmRJbmRleCIsImluZGV4Q0EiLCJzcGxpY2UiLCJzdHJpbmdpZnkiLCJjdXJyZW50UHJvamVjdCIsImNhcmRUb1JlbW92ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW1vdmVDaGlsZCIsImNhcmQiLCJjcmVhdGVFbGVtZW50IiwiY29sb3IiLCJzZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImJvZHkiLCJib2R5VGl0bGUiLCJib2R5UCIsImtleXBhZCIsImRlbEJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFbGVtZW50IiwiYWxsVG9Eb3MiLCJwcm9qZWN0c0FycmF5IiwiY3VycmVudEFjYyIsImNvbnRlbnQiLCJwdExpc3QiLCJ0b0xpc3QiLCJwcm9qZWN0TGlzdCIsImRpdlByb2plY3RzQnV0dG9uIiwiZm9ybSIsImlucHV0TmFtZSIsInNwYW5BZGRCdXR0b24iLCJhZGRCdXR0b24iLCJhZGRCdXR0b25Db21wb25lbnQiLCJ1TGlzdCIsImluZGV4IiwibGVuZ3RoIiwibGkiLCJidXR0b24iLCJlIiwidGFyZ2V0IiwibGlzdCIsImFycmF5QXV4IiwicmVuZGVyQ2FyZCIsInByaW50IiwidG9Eb0xpc3QiLCJjaGlsZHJlbiIsInB1c2giLCJ2YWx1ZSIsIml0ZW0iLCJ0b0RvTGlzdFNob3ciLCJrZXkiLCJwcm9qZWN0TGlzdENvbXBvbmVudCIsInRvRG9MaXN0QmxvY2siLCJpbnB1dFRpdGxlTkxhYmVsIiwibGFiZWwiLCJpbnB1dCIsImlucHV0RGVzY3JpcHRpb25OTGFiZWwiLCJpbnB1dER1ZURhdGVOTGFiZWwiLCJpbnB1dFByaW9yaXR5TkxhYmVsIiwic3VtYml0QnV0dG9uIiwidG9Eb0NvbGxlY3Rpb24iLCJwcmV2ZW50RGVmYXVsdCIsImRlc2MiLCJwcmlvciIsInByaW9yaXR5TG93IiwicHJpb3JpdHlNZWRpdW0iLCJwcmlvcml0eVVyZ2VudCIsImNoZWNrZWQiLCJuYW1lIiwiZ2V0UHJpb3JpdHkiLCJ0b0RvIl0sIm1hcHBpbmdzIjoibUJBQUEsTUFBTUEsRUFBWUMsT0FBT0MsYUFDekIsSUFBSUMsRUFBV0MsS0FBS0MsTUFBTUwsRUFBVU0sUUFBUSxrQkFDNUNILEVBQVlBLEdBQVcsQ0FBQyxXQ0Z4QixNQUFNSSxFQUNKLFlBQVlDLEVBQU9DLEVBQWFDLEVBQU1DLEdBQ3BDQyxLQUFLSixNQUFRQSxFQUNiSSxLQUFLSCxZQUFjQSxFQUNuQkcsS0FBS0YsS0FBT0EsRUFDWkUsS0FBS0QsU0FBV0EsRUFDaEIsSUFBSUUsRUFBTVgsYUFBYUksUUFBUSxXQUMvQk0sS0FBS0UsR0FBS0QsSUFDVlgsYUFBYWEsUUFBUSxVQUFXRixHQUdsQyxnQkFDRSxJQUFJRyxFQUFlWixLQUFLQyxNQUFNSCxhQUFhSSxRQUFRLFlBQy9DVyxFQUFlYixLQUFLQyxNQUFNSCxhQUFhSSxRQUFRLGlCQUMvQ1ksRUFBWUMsR0FDUEEsRUFBUUwsSUFBTUYsS0FBS0UsR0FFeEJNLEVBQWVKLEVBQWFLLFVBQVVILEdBQ3RDSSxFQUFVTCxFQUFhSSxVQUFVSCxHQUNyQ0YsRUFBYU8sT0FBT0gsRUFBYyxHQUNsQ2xCLGFBQWFhLFFBQVEsVUFBV1gsS0FBS29CLFVBQVVSLElBRS9DQyxFQUFhTSxPQUFPRCxFQUFTLEdBQzdCLElBQUlHLEVBQWlCdkIsYUFBYUksUUFBUSxrQkFDMUNKLGFBQWFhLFFBQVFVLEVBQWdCckIsS0FBS29CLFVBQVVQLElBRXBELElBQUlTLEVBQWVDLFNBQVNDLGVBQWUsR0FBR2hCLEtBQUtFLE1BQ2hDYSxTQUFTQyxlQUFlLGdCQUM5QkMsWUFBWUgsR0FHM0IsUUFDRSxJQUFJSSxFQUFPSCxTQUFTSSxjQUFjLE9BQzlCQyxFQUFRLEtBRVZBLEVBRG1CLE9BQWpCcEIsS0FBS0QsU0FDQyxVQUNrQixVQUFqQkMsS0FBS0QsU0FDTixVQUVBLFNBRVZtQixFQUFLRyxhQUFhLFFBQVMsc0JBQXNCRCxLQUNqREYsRUFBS0csYUFBYSxLQUFNLEdBQUdyQixLQUFLRSxNQUVoQyxJQUFJTixFQUFRbUIsU0FBU0ksY0FBYyxPQUNuQ3ZCLEVBQU15QixhQUFhLFFBQVMsMEJBQzVCekIsRUFBTTBCLFVBQVl0QixLQUFLSixNQUN2QnNCLEVBQUtLLFlBQVkzQixHQUVqQixJQUFJNEIsRUFBT1QsU0FBU0ksY0FBYyxPQUNsQ0ssRUFBS0gsYUFBYSxRQUFTLHdCQUMzQkgsRUFBS0ssWUFBWUMsR0FFakIsSUFBSUMsRUFBWVYsU0FBU0ksY0FBYyxNQUN2Q00sRUFBVUosYUFBYSxRQUFTLHlCQUNoQ0ksRUFBVUgsVUFBWXRCLEtBQUtILFlBQzNCMkIsRUFBS0QsWUFBWUUsR0FFakIsSUFBSUMsRUFBUVgsU0FBU0ksY0FBYyxLQUNuQ08sRUFBTUwsYUFBYSxRQUFTLHdCQUM1QkssRUFBTUosVUFBWXRCLEtBQUtGLEtBQ3ZCMEIsRUFBS0QsWUFBWUcsR0FFakJBLEVBQVFYLFNBQVNJLGNBQWMsS0FDL0JPLEVBQU1MLGFBQWEsUUFBUyx3QkFDNUJLLEVBQU1KLFVBQVl0QixLQUFLRCxTQUN2QnlCLEVBQUtELFlBQVlHLEdBRWpCLE1BQU1DLEVBQVNaLFNBQVNJLGNBQWMsT0FDdENRLEVBQU9OLGFBQWEsUUFBUyxpQkFDN0JILEVBQUtLLFlBQVlJLEdBRWpCLE1BQU1DLEVBQVliLFNBQVNJLGNBQWMsVUFPekMsT0FOQVMsRUFBVVAsYUFBYSxLQUFNLGdCQUM3Qk8sRUFBVVAsYUFBYSxRQUFTLFNBQ2hDTyxFQUFVTixVQUFZLFNBQ3RCSyxFQUFPSixZQUFZSyxHQUNuQkEsRUFBVUMsaUJBQWlCLFNBQVMsSUFBTTdCLEtBQUs4QixrQkFFeENaLEdDNUVYLElBQUlMLEVBQWlCdkIsYUFBYUksUUFBUSxrQkFDMUNtQixJQUFtQnZCLGFBQWFhLFFBQVEsaUJBQWtCLFdBQzFELElBQUk0QixFQUFXdkMsS0FBS0MsTUFBTUgsYUFBYUksUUFBUSxrQkFDL0NxQyxJQUFhLEdBRWIsSUFBSUMsRUFBZ0J4QyxLQUFLQyxNQUFNSCxhQUFhSSxRQUFRLGtCQUNwRHNDLElBQWtCLEdBQ2xCLElBQUkzQixFQUFlYixLQUFLQyxNQUFNSCxhQUFhSSxRQUFRLFlBQ25EVyxJQUFpQixHQ1RqQixJQUFJLEVBQVdiLEtBQUtDLE1BQU1ILGFBQWFJLFFBQVEsa0JBQy9DLElBQWEsR0NDYixJQUFJdUMsRUFBYTNDLGFBQWFJLFFBQVEsV0FDdEN1QyxJQUFlM0MsYUFBYWEsUUFBUSxVQUFXLEdBQy9DLElBQUksRUFBaUJiLGFBQWFJLFFBQVEsa0JBQzFDLElBQW1CSixhQUFhYSxRQUFRLGlCQUFrQixXQUV4QyxNQUREWCxLQUFLQyxNQUFNSCxhQUFhSSxRQUFRLGFBRS9DSixhQUFhYSxRQUFRLFVBQVcsTUFHbEMsSUFBSSxFQUFlWCxLQUFLQyxNQUFNSCxhQUFhSSxRQUFRLFlBQ25ELElBQWlCLEdBQ2pCSixhQUFhYSxRQUFRLGVBQWdCWCxLQUFLb0IsVUFBVSxJQUVwRCxNQUFNc0IsRUFBVW5CLFNBQVNDLGVBQWUsV0FFbENtQixFQUFTcEIsU0FBU0ksY0FBYyxPQUV0Q2dCLEVBQU9kLGFBQWEsUUFBUyxTQUM3QmMsRUFBT2QsYUFBYSxLQUFNLGVBQzFCYSxFQUFRWCxZQUFZWSxHQUVwQixNQUFNQyxFQUFTckIsU0FBU0ksY0FBYyxPQUN0Q2lCLEVBQU9mLGFBQWEsUUFBUyxTQUM3QmUsRUFBT2YsYUFBYSxLQUFNLFlBQzFCYSxFQUFRWCxZQUFZYSxHQUVwQixJQUFJQyxFRmpCeUIsTUFDM0IsTUFBTUEsRUFBY3RCLFNBQVNDLGVBQWUsZUFFdENzQixFQUFvQnZCLFNBQVNJLGNBQWMsT0FDakRtQixFQUFrQmpCLGFBQWEsUUFBUyxPQUV4QyxNQUFNekIsRUFBUW1CLFNBQVNJLGNBQWMsTUFDckN2QixFQUFNeUIsYUFBYSxRQUFTLFNBQzVCekIsRUFBTTBCLFVBQVksV0FDbEJnQixFQUFrQmYsWUFBWTNCLEdBQzlCLE1BQU0yQyxFRm5CbUIsTUFDekIsTUFBTUEsRUFBT3hCLFNBQVNJLGNBQWMsUUFDcENvQixFQUFLbEIsYUFBYSxLQUFNLFVBQ3hCLE1BQU1tQixFQUFZekIsU0FBU0ksY0FBYyxTQUN6Q3FCLEVBQVVuQixhQUFhLE9BQVEsUUFDL0JtQixFQUFVbkIsYUFBYSxjQUFlLGdCQUN0Q21CLEVBQVVuQixhQUFhLEtBQU0sYUFDN0JrQixFQUFLaEIsWUFBWWlCLEdBQ2pCLE1BQU1DLEVBQWdCMUIsU0FBU0ksY0FBYyxRQUM3Q3NCLEVBQWNwQixhQUFhLFFBQVMsU0FDcEMsTUFBTXFCLEVBQVkzQixTQUFTSSxjQUFjLFVBUXpDLE9BUEF1QixFQUFVckIsYUFBYSxPQUFRLFVBQy9CcUIsRUFBVXJCLGFBQWEsS0FBTSxnQkFDN0JxQixFQUFVcEIsVUFBWSxjQUV0Qm1CLEVBQWNsQixZQUFZbUIsR0FDMUJILEVBQUtoQixZQUFZa0IsR0FFVkYsR0VDTUksR0FDYkwsRUFBa0JmLFlBQVlnQixHQUU5QixNQUFNSyxFQUFRN0IsU0FBU0ksY0FBYyxNQUVyQyxJQUFLLElBQUkwQixFQUFRLEVBQUdBLEVBQVF0RCxFQUFTdUQsT0FBUUQsSUFBUyxDQUNwRCxJQUFJRSxFQUFLaEMsU0FBU0ksY0FBYyxNQUM1QjZCLEVBQVNqQyxTQUFTSSxjQUFjLFVBQ3BDNkIsRUFBTzFCLFVBQVkvQixFQUFTc0QsR0FDNUJHLEVBQU9uQixpQkFBaUIsU0FBVW9CLElBQ2hDM0QsYUFBYWEsUUFBUSxpQkFBa0I4QyxFQUFFQyxPQUFPNUIsV0FDaERqQixFQUFlYixLQUFLQyxNQUFNSCxhQUFhSSxRQUFRdUQsRUFBRUMsT0FBTzVCLFlBRXhEaEMsYUFBYWEsUUFBUSxlQUFnQlgsS0FBS29CLFVBQVVQLElBQ3BELElBQUk4QyxFQUFPcEMsU0FBU0MsZUFBZSxnQkFFbkNtQyxFQUFLN0IsVUFBWSxLQUVqQixNQUFNOEIsRUFDYyxXQUZDOUQsYUFBYUksUUFBUSxrQkFHcENxQyxFQUNBdkMsS0FBS0MsTUFBTUgsYUFBYUksUUFBUSxpQkFFdEMsSUFBSyxJQUFJbUQsRUFBUSxFQUFHQSxFQUFRTyxFQUFTTixPQUFRRCxJQUFTLENBQ3BELElBQUkzQixFQUFPLElBQUl2QixFQUNieUQsRUFBU1AsR0FBT2pELE1BQ2hCd0QsRUFBU1AsR0FBT2hELFlBQ2hCdUQsRUFBU1AsR0FBTy9DLEtBQ2hCc0QsRUFBU1AsR0FBTzlDLFVBR2xCLEdBQUltQixFQUFLdEIsTUFBTyxDQUNkLElBQUl5RCxFQUFhbkMsRUFBS29DLFFBQ3RCSCxFQUFLNUIsWUFBWThCLEdBQ2pCRSxTQUFTaEMsWUFBWTRCLFFBSzNCSixFQUFHeEIsWUFBWXlCLEdBQ2ZKLEVBQU1yQixZQUFZd0IsR0FFbEIxQyxFQUFlYixLQUFLQyxNQUFNSCxhQUFhSSxRQUFRbUIsSUE0Q2pELE9BekNBd0IsRUFBWWQsWUFBWWUsR0FFeEJELEVBQVlkLFlBQVlxQixHQUVITCxFQUFLaUIsU0FBUyxHQUFHQSxTQUFTLEdBQ2xDM0IsaUJBQWlCLFNBQVVvQixJQUN0QzFELEVBQVNrRSxLQUFLbEIsRUFBS2lCLFNBQVMsR0FBR0UsT0FDL0IsSUFBSVgsRUFBS2hDLFNBQVNJLGNBQWMsTUFDNUI2QixFQUFTakMsU0FBU0ksY0FBYyxVQUNwQzZCLEVBQU8xQixVQUFZaUIsRUFBS2lCLFNBQVMsR0FBR0UsTUFDcENWLEVBQU9uQixpQkFBaUIsU0FBVW9CLElBQ2hDM0QsYUFBYWEsUUFBUSxpQkFBa0I4QyxFQUFFQyxPQUFPNUIsV0FDaEQsSUFBSXFDLEVBQU9yRSxhQUFhSSxRQUFRLGtCQUNoQ1csRUFBZWIsS0FBS0MsTUFBTUgsYUFBYUksUUFBUWlFLElBQy9DckUsYUFBYWEsUUFBUSxlQUFnQlgsS0FBS29CLFVBQVVQLElBQ3JDVyxlQUFlLGdCQUNyQk0sVUFBWSxLQUNyQixJQUFLLElBQUl1QixFQUFRLEVBQUdBLEVBQVF4QyxFQUFheUMsT0FBUUQsSUFBUyxDQUN4RCxNQUFNM0IsRUFBTyxJQUFJdkIsRUFDZlUsRUFBYXdDLEdBQU9qRCxNQUNwQlMsRUFBYXdDLEdBQU9oRCxZQUNwQlEsRUFBYXdDLEdBQU8vQyxLQUNwQk8sRUFBYXdDLEdBQU85QyxVQUV0QixHQUFJbUIsRUFBS2hCLEdBQUksQ0FDWCxJQUFJbUQsRUFBYW5DLEVBQUtvQyxRQUN0Qk0sRUFBYXJDLFlBQVk4QixRQUkvQi9ELGFBQWFhLFFBQVEsaUJBQWtCb0MsRUFBS2lCLFNBQVMsR0FBR0UsT0FDeEQsSUFBSUcsRUFBTXRCLEVBQUtpQixTQUFTLEdBQUdFLE1BQzNCcEUsYUFBYWEsUUFBUSxHQUFHMEQsSUFBT3JFLEtBQUtvQixVQUFVLEtBQzlDdEIsYUFBYWEsUUFBUSxlQUFnQixNQUNyQyxJQUFJeUQsRUFBZTdDLFNBQVNDLGVBQWUsZ0JBQzNDNEMsRUFBYXRDLFVBQVksS0FDekJ5QixFQUFHeEIsWUFBWXlCLEdBQ2ZKLEVBQU1yQixZQUFZd0IsR0FDbEJ6RCxhQUFhYSxRQUFRLGdCQUFpQlgsS0FBS29CLFVBQVVyQixPQUdoRDhDLEdFL0VTeUIsR0FFbEI1QixFQUFRWCxZQUFZYyxHQUVwQixNQUFNLEVEdURpQixNQUNyQixNQUFNa0IsRUFBV3hDLFNBQVNDLGVBQWUsWUFFbkNwQixFQUFRbUIsU0FBU0ksY0FBYyxNQUNyQ3ZCLEVBQU15QixhQUFhLFFBQVMsZUFDNUJ6QixFQUFNMEIsVUFBWSxlQUVsQmlDLEVBQVNoQyxZQUFZM0IsR0FFckIsTUFBTW1FLEVBQWdCaEQsU0FBU0ksY0FBYyxPQUM3QzRDLEVBQWMxQyxhQUFhLFFBQVMsaUJBRXBDMEMsRUFBY3hDLFlBaEdILE1BQ1gsTUFBTWdCLEVBQU94QixTQUFTSSxjQUFjLFFBQzlCNkMsRUFBbUJqRCxTQUFTSSxjQUFjLE9BQ2hEb0IsRUFBS2hCLFlBQVl5QyxHQUNqQixJQUFJQyxFQUFRbEQsU0FBU0ksY0FBYyxTQUNuQzhDLEVBQU01QyxhQUFhLE1BQU8sU0FDMUI0QyxFQUFNM0MsVUFBWSxTQUNsQjBDLEVBQWlCekMsWUFBWTBDLEdBRTdCLElBQUlDLEVBQVFuRCxTQUFTSSxjQUFjLFNBQ25DK0MsRUFBTTdDLGFBQWEsT0FBUSxRQUMzQjZDLEVBQU03QyxhQUFhLE9BQVEsU0FDM0I2QyxFQUFNN0MsYUFBYSxLQUFNLFNBQ3pCMkMsRUFBaUJ6QyxZQUFZMkMsR0FFN0IsTUFBTUMsRUFBeUJwRCxTQUFTSSxjQUFjLE9BQ3REb0IsRUFBS2hCLFlBQVk0QyxHQUNqQkYsRUFBUWxELFNBQVNJLGNBQWMsU0FDL0I4QyxFQUFNM0MsVUFBWSxlQUNsQjJDLEVBQU01QyxhQUFhLE1BQU8sZUFDMUI4QyxFQUF1QjVDLFlBQVkwQyxHQUVuQ0MsRUFBUW5ELFNBQVNJLGNBQWMsU0FDL0IrQyxFQUFNN0MsYUFBYSxPQUFRLFFBQzNCNkMsRUFBTTdDLGFBQWEsT0FBUSxlQUMzQjZDLEVBQU03QyxhQUFhLEtBQU0sZUFDekI4QyxFQUF1QjVDLFlBQVkyQyxHQUVuQyxNQUFNRSxFQUFxQnJELFNBQVNJLGNBQWMsT0FDbERvQixFQUFLaEIsWUFBWTZDLEdBQ2pCSCxFQUFRbEQsU0FBU0ksY0FBYyxTQUMvQjhDLEVBQU0zQyxVQUFZLGFBQ2xCMkMsRUFBTTVDLGFBQWEsTUFBTyxXQUMxQitDLEVBQW1CN0MsWUFBWTBDLEdBRS9CQyxFQUFRbkQsU0FBU0ksY0FBYyxTQUMvQitDLEVBQU03QyxhQUFhLE9BQVEsUUFDM0I2QyxFQUFNN0MsYUFBYSxPQUFRLFdBQzNCNkMsRUFBTTdDLGFBQWEsS0FBTSxXQUN6QitDLEVBQW1CN0MsWUFBWTJDLEdBRS9CLE1BQU1HLEVBQXNCdEQsU0FBU0ksY0FBYyxPQUNuRG9CLEVBQUtoQixZQUFZOEMsR0FDakJKLEVBQVFsRCxTQUFTSSxjQUFjLFNBQy9COEMsRUFBTTNDLFVBQVksWUFDbEIyQyxFQUFNNUMsYUFBYSxNQUFPLFlBQzFCZ0QsRUFBb0I5QyxZQUFZMEMsR0FFaEMsSUFBSyxJQUFJcEIsRUFBUSxFQUFHQSxFQUFRLEVBQUdBLElBQVMsQ0FFdEMsSUFBSTlDLEVBQ0osT0FGQW1FLEVBQVFuRCxTQUFTSSxjQUFjLFNBRXZCMEIsR0FDTixLQUFLLEVBQ0g5QyxFQUFXLE1BQ1gsTUFFRixLQUFLLEVBQ0hBLEVBQVcsU0FDWCxNQUNGLEtBQUssRUFDSEEsRUFBVyxTQU9ma0UsRUFBUWxELFNBQVNJLGNBQWMsU0FDL0I4QyxFQUFNNUMsYUFBYSxNQUFPdEIsR0FDMUJrRSxFQUFNM0MsVUFBWXZCLEVBQ2xCc0UsRUFBb0I5QyxZQUFZMEMsR0FDaENDLEVBQU03QyxhQUFhLE9BQVEsU0FDM0I2QyxFQUFNN0MsYUFBYSxPQUFRdEIsR0FDM0JtRSxFQUFNN0MsYUFBYSxLQUFNdEIsR0FDekJzRSxFQUFvQjlDLFlBQVkyQyxHQUdsQyxNQUFNSSxFQUFldkQsU0FBU0ksY0FBYyxTQUk1QyxPQUhBb0IsRUFBS2hCLFlBQVkrQyxHQUNqQkEsRUFBYWpELGFBQWEsT0FBUSxVQUNsQ2lELEVBQWFqRCxhQUFhLEtBQU0sZ0JBQ3pCa0IsR0FlbUIsSUFDMUJnQixFQUFTaEMsWUFBWXdDLEdBRXJCLE1BQU1ILEVBQWU3QyxTQUFTSSxjQUFjLE9BQzVDeUMsRUFBYXZDLGFBQWEsS0FBTSxnQkFDaENrQyxFQUFTaEMsWUFBWXFDLEdBQ3JCLElBQUkvQyxFQUFpQnZCLGFBQWFJLFFBQVEsa0JBQzFDLE1BQU0wRCxFQUNjLFdBQWxCdkMsRUFDSSxFQUNBckIsS0FBS0MsTUFBTUgsYUFBYUksUUFBUW1CLElBRXRDLElBQUssSUFBSWdDLEVBQVEsRUFBR0EsRUFBUU8sRUFBU04sT0FBUUQsSUFBUyxDQUNwRCxNQUFNM0IsRUFBTyxJQUFJdkIsRUFDZnlELEVBQVNQLEdBQU9qRCxNQUNoQndELEVBQVNQLEdBQU9oRCxZQUNoQnVELEVBQVNQLEdBQU8vQyxLQUNoQnNELEVBQVNQLEdBQU85QyxVQUVsQixHQUFJbUIsRUFBS3RCLE1BQU8sQ0FDZCxJQUFJeUQsRUFBYW5DLEVBQUtvQyxRQUN0Qk0sRUFBYXJDLFlBQVk4QixJQUk3QixPQUFPRSxHQzVGUWdCLEdBQ2pCckMsRUFBUVgsWUFBWSxHQWdDQ1IsU0FBU0MsZUFBZSxnQkFDaENhLGlCQUFpQixTQUFVb0IsSUFDdENBLEVBQUV1QixpQkFDRixJQUFJNUUsRUFoQ1FtQixTQUFTQyxlQUFlLFNBQ3ZCMEMsTUFnQ1RlLEVBNUJjMUQsU0FBU0MsZUFBZSxlQUN2QjBDLE1BNEJmNUQsRUF4Qk9pQixTQUFTQyxlQUFlLFdBQ3ZCMEMsTUF3QlJnQixFQXJCYyxNQUNsQixJQUFJQyxFQUFjNUQsU0FBU0MsZUFBZSxPQUN0QzRELEVBQWlCN0QsU0FBU0MsZUFBZSxVQUN6QzZELEVBQWlCOUQsU0FBU0MsZUFBZSxVQUN6Q2pCLEVBQVcsS0FRZixPQU5FQSxFQURFNEUsRUFBWUcsUUFDSEgsRUFBWUksS0FDZEgsRUFBZUUsUUFDYkYsRUFBZUcsS0FFZkYsRUFBZUUsS0FFckJoRixHQVNLaUYsR0FFUkMsRUFBTyxJQUFJdEYsRUFBS0MsRUFBTzZFLEVBQU0zRSxFQUFNNEUsR0FDdkNkLGFBQWFyQyxZQUFZMEQsRUFBSzNCLFNBQzlCLE9BQWMyQixHQUNkLEVBQWV6RixLQUFLQyxNQUFNSCxhQUFhSSxRQUFRLGlCQUMvQ0osYUFBYWEsUUFBUSxVQUFXWCxLQUFLb0IsVUFBVSxJQUMvQyxFQUFhNkMsS0FBS3dCLEdBQ2xCLEVBQWlCM0YsYUFBYUksUUFBUSxrQkFDdENKLGFBQWFhLFFBQVEsZUFBZ0JYLEtBQUtvQixVQUFVLElBQ3BEdEIsYUFBYWEsUUFBUSxHQUFHLElBQWtCWCxLQUFLb0IsVUFBVSxJQUN6RHRCLGFBQWFhLFFBQVEsZ0JBQWlCWCxLQUFLb0IsVUFBVSxJQUNyRCxFQUFTVyxZQUFZcUMsa0IiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG15U3RvcmFnZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7XHJcbmxldCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobXlTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIpKTtcclxucHJvamVjdHMgPSAhcHJvamVjdHMgPyBbXCJEZWZhdWx0XCJdIDogcHJvamVjdHM7XHJcblxyXG5jb25zdCBhZGRCdXR0b25Db21wb25lbnQgPSAoKSA9PiB7XHJcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xyXG4gIGZvcm0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJpZEZvcm1cIik7XHJcbiAgY29uc3QgaW5wdXROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gIGlucHV0TmFtZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dFwiKTtcclxuICBpbnB1dE5hbWUuc2V0QXR0cmlidXRlKFwicGxhY2Vob2xkZXJcIiwgXCJQcm9qZWN0IG5hbWVcIik7XHJcbiAgaW5wdXROYW1lLnNldEF0dHJpYnV0ZShcImlkXCIsIFwibmFtZUZpZWxkXCIpO1xyXG4gIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXROYW1lKTtcclxuICBjb25zdCBzcGFuQWRkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XHJcbiAgc3BhbkFkZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNvbC00XCIpO1xyXG4gIGNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJzdWJtaXRcIik7XHJcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZShcImlkXCIsIFwiYnV0dG9uU3VibWl0XCIpO1xyXG4gIGFkZEJ1dHRvbi5pbm5lckhUTUwgPSBcIkFkZCBwcm9qZWN0XCI7XHJcblxyXG4gIHNwYW5BZGRCdXR0b24uYXBwZW5kQ2hpbGQoYWRkQnV0dG9uKTtcclxuICBmb3JtLmFwcGVuZENoaWxkKHNwYW5BZGRCdXR0b24pO1xyXG5cclxuICByZXR1cm4gZm9ybTtcclxufTtcclxuXHJcbmV4cG9ydCB7IHByb2plY3RzLCBhZGRCdXR0b25Db21wb25lbnQgfTtcclxuIiwiY2xhc3MgVG9EbyB7XHJcbiAgY29uc3RydWN0b3IodGl0bGUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSkge1xyXG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgdGhpcy5kYXRlID0gZGF0ZTtcclxuICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcclxuICAgIGxldCBhY2MgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImFjY1RvRG9cIik7XHJcbiAgICB0aGlzLmlkID0gYWNjKys7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImFjY1RvRG9cIiwgYWNjKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUVsZW1lbnQoKSB7XHJcbiAgICBsZXQgYXJyYXlEZWZhdWx0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIkRlZmF1bHRcIikpO1xyXG4gICAgbGV0IGN1cnJlbnRBcnJheSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50QXJyYXlcIikpO1xyXG4gICAgbGV0IGZpbmRCeUlkID0gKGVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuIGVsZW1lbnQuaWQgPT0gdGhpcy5pZDtcclxuICAgIH07XHJcbiAgICBsZXQgaW5kZXhEZWZhdWx0ID0gYXJyYXlEZWZhdWx0LmZpbmRJbmRleChmaW5kQnlJZCk7XHJcbiAgICBsZXQgaW5kZXhDQSA9IGN1cnJlbnRBcnJheS5maW5kSW5kZXgoZmluZEJ5SWQpO1xyXG4gICAgYXJyYXlEZWZhdWx0LnNwbGljZShpbmRleERlZmF1bHQsIDEpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJEZWZhdWx0XCIsIEpTT04uc3RyaW5naWZ5KGFycmF5RGVmYXVsdCkpO1xyXG5cclxuICAgIGN1cnJlbnRBcnJheS5zcGxpY2UoaW5kZXhDQSwgMSk7XHJcbiAgICBsZXQgY3VycmVudFByb2plY3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY3VycmVudFByb2plY3QsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRBcnJheSkpO1xyXG5cclxuICAgIGxldCBjYXJkVG9SZW1vdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLmlkfWApO1xyXG4gICAgbGV0IHNob3dUb0RvTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9Eb0xpc3RTaG93XCIpO1xyXG4gICAgc2hvd1RvRG9MaXN0LnJlbW92ZUNoaWxkKGNhcmRUb1JlbW92ZSk7XHJcbiAgfVxyXG5cclxuICBwcmludCgpIHtcclxuICAgIGxldCBjYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGxldCBjb2xvciA9IG51bGw7XHJcbiAgICBpZiAodGhpcy5wcmlvcml0eSA9PSBcImxvd1wiKSB7XHJcbiAgICAgIGNvbG9yID0gXCJwcmltYXJ5XCI7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMucHJpb3JpdHkgPT0gXCJtZWRpdW1cIikge1xyXG4gICAgICBjb2xvciA9IFwid2FybmluZ1wiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29sb3IgPSBcImRhbmdlclwiO1xyXG4gICAgfVxyXG4gICAgY2FyZC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBgY2FyZCB0ZXh0LXdoaXRlIGJnLSR7Y29sb3J9YCk7XHJcbiAgICBjYXJkLnNldEF0dHJpYnV0ZShcImlkXCIsIGAke3RoaXMuaWR9YCk7XHJcblxyXG4gICAgbGV0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIHRpdGxlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY2FyZC1oZWFkZXIgdGV4dC13aGl0ZVwiKTtcclxuICAgIHRpdGxlLmlubmVySFRNTCA9IHRoaXMudGl0bGU7XHJcbiAgICBjYXJkLmFwcGVuZENoaWxkKHRpdGxlKTtcclxuXHJcbiAgICBsZXQgYm9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBib2R5LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY2FyZC1ib2R5IHRleHQtd2hpdGVcIik7XHJcbiAgICBjYXJkLmFwcGVuZENoaWxkKGJvZHkpO1xyXG5cclxuICAgIGxldCBib2R5VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDVcIik7XHJcbiAgICBib2R5VGl0bGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjYXJkLXRpdGxlIHRleHQtd2hpdGVcIik7XHJcbiAgICBib2R5VGl0bGUuaW5uZXJIVE1MID0gdGhpcy5kZXNjcmlwdGlvbjtcclxuICAgIGJvZHkuYXBwZW5kQ2hpbGQoYm9keVRpdGxlKTtcclxuXHJcbiAgICBsZXQgYm9keVAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgIGJvZHlQLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY2FyZC10ZXh0IHRleHQtd2hpdGVcIik7XHJcbiAgICBib2R5UC5pbm5lckhUTUwgPSB0aGlzLmRhdGU7XHJcbiAgICBib2R5LmFwcGVuZENoaWxkKGJvZHlQKTtcclxuXHJcbiAgICBib2R5UCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gICAgYm9keVAuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjYXJkLXRleHQgdGV4dC13aGl0ZVwiKTtcclxuICAgIGJvZHlQLmlubmVySFRNTCA9IHRoaXMucHJpb3JpdHk7XHJcbiAgICBib2R5LmFwcGVuZENoaWxkKGJvZHlQKTtcclxuXHJcbiAgICBjb25zdCBrZXlwYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAga2V5cGFkLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwicm93IGNvbnRhaW5lclwiKTtcclxuICAgIGNhcmQuYXBwZW5kQ2hpbGQoa2V5cGFkKTtcclxuXHJcbiAgICBjb25zdCBkZWxCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZShcImlkXCIsIFwiZGVsZXRlQnV0dG9uXCIpO1xyXG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY29sLTJcIik7XHJcbiAgICBkZWxCdXR0b24uaW5uZXJIVE1MID0gXCJEZWxldGVcIjtcclxuICAgIGtleXBhZC5hcHBlbmRDaGlsZChkZWxCdXR0b24pO1xyXG4gICAgZGVsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLnJlbW92ZUVsZW1lbnQoKSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBUb0RvIH07XHJcbiIsImltcG9ydCB7IHByb2plY3RzLCBhZGRCdXR0b25Db21wb25lbnQgfSBmcm9tIFwiLi9hZGRCdXR0b25cIjtcclxuaW1wb3J0IHsgVG9EbyB9IGZyb20gXCIuL3RvRG9cIjtcclxuXHJcbmxldCBjdXJyZW50UHJvamVjdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFByb2plY3RcIik7XHJcbmN1cnJlbnRQcm9qZWN0ID8/PSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIFwiRGVmYXVsdFwiKTtcclxubGV0IGFsbFRvRG9zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImFsbFRvRG9zQXJyYXlcIikpO1xyXG5hbGxUb0RvcyA/Pz0gW107XHJcblxyXG5sZXQgcHJvamVjdHNBcnJheSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIpKTtcclxucHJvamVjdHNBcnJheSA/Pz0gW107XHJcbmxldCBjdXJyZW50QXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiRGVmYXVsdFwiKSk7XHJcbmN1cnJlbnRBcnJheSA/Pz0gW107XHJcblxyXG5jb25zdCBwcm9qZWN0TGlzdENvbXBvbmVudCA9ICgpID0+IHtcclxuICBjb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvamVjdExpc3RcIik7XHJcblxyXG4gIGNvbnN0IGRpdlByb2plY3RzQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICBkaXZQcm9qZWN0c0J1dHRvbi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInJvd1wiKTtcclxuXHJcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDFcIik7XHJcbiAgdGl0bGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjb2wtOFwiKTtcclxuICB0aXRsZS5pbm5lckhUTUwgPSBcIlByb2plY3RzXCI7XHJcbiAgZGl2UHJvamVjdHNCdXR0b24uYXBwZW5kQ2hpbGQodGl0bGUpO1xyXG4gIGNvbnN0IGZvcm0gPSBhZGRCdXR0b25Db21wb25lbnQoKTtcclxuICBkaXZQcm9qZWN0c0J1dHRvbi5hcHBlbmRDaGlsZChmb3JtKTtcclxuXHJcbiAgY29uc3QgdUxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidWxcIik7XHJcblxyXG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBwcm9qZWN0cy5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgIGxldCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcclxuICAgIGxldCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgYnV0dG9uLmlubmVySFRNTCA9IHByb2plY3RzW2luZGV4XTtcclxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiLCBlLnRhcmdldC5pbm5lckhUTUwpO1xyXG4gICAgICBjdXJyZW50QXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGUudGFyZ2V0LmlubmVySFRNTCkpO1xyXG5cclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50QXJyYXlcIiwgSlNPTi5zdHJpbmdpZnkoY3VycmVudEFycmF5KSk7XHJcbiAgICAgIGxldCBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0RvTGlzdFNob3dcIik7XHJcblxyXG4gICAgICBsaXN0LmlubmVySFRNTCA9IG51bGw7XHJcbiAgICAgIGxldCBjdXJyZW50UHJvamVjdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFByb2plY3RcIik7XHJcbiAgICAgIGNvbnN0IGFycmF5QXV4ID1cclxuICAgICAgICBjdXJyZW50UHJvamVjdCA9PSBcIkRlZmF1bHRcIlxyXG4gICAgICAgICAgPyBhbGxUb0Rvc1xyXG4gICAgICAgICAgOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudEFycmF5XCIpKTtcclxuXHJcbiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhcnJheUF1eC5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBsZXQgY2FyZCA9IG5ldyBUb0RvKFxyXG4gICAgICAgICAgYXJyYXlBdXhbaW5kZXhdLnRpdGxlLFxyXG4gICAgICAgICAgYXJyYXlBdXhbaW5kZXhdLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgYXJyYXlBdXhbaW5kZXhdLmRhdGUsXHJcbiAgICAgICAgICBhcnJheUF1eFtpbmRleF0ucHJpb3JpdHlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoY2FyZC50aXRsZSkge1xyXG4gICAgICAgICAgbGV0IHJlbmRlckNhcmQgPSBjYXJkLnByaW50KCk7XHJcbiAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKHJlbmRlckNhcmQpO1xyXG4gICAgICAgICAgdG9Eb0xpc3QuYXBwZW5kQ2hpbGQobGlzdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBsaS5hcHBlbmRDaGlsZChidXR0b24pO1xyXG4gICAgdUxpc3QuYXBwZW5kQ2hpbGQobGkpO1xyXG5cclxuICAgIGN1cnJlbnRBcnJheSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oY3VycmVudFByb2plY3QpKTtcclxuICB9XHJcblxyXG4gIHByb2plY3RMaXN0LmFwcGVuZENoaWxkKGRpdlByb2plY3RzQnV0dG9uKTtcclxuXHJcbiAgcHJvamVjdExpc3QuYXBwZW5kQ2hpbGQodUxpc3QpO1xyXG5cclxuICBjb25zdCBzdWJtaXRCdXR0b24gPSBmb3JtLmNoaWxkcmVuWzFdLmNoaWxkcmVuWzBdO1xyXG4gIHN1Ym1pdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIHByb2plY3RzLnB1c2goZm9ybS5jaGlsZHJlblswXS52YWx1ZSk7XHJcbiAgICBsZXQgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XHJcbiAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcclxuICAgIGJ1dHRvbi5pbm5lckhUTUwgPSBmb3JtLmNoaWxkcmVuWzBdLnZhbHVlO1xyXG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIGUudGFyZ2V0LmlubmVySFRNTCk7XHJcbiAgICAgIGxldCBpdGVtID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiKTtcclxuICAgICAgY3VycmVudEFycmF5ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShpdGVtKSk7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudEFycmF5XCIsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRBcnJheSkpO1xyXG4gICAgICBsZXQgdG9Eb0xpc3QgPSBnZXRFbGVtZW50QnlJZChcInRvRG9MaXN0U2hvd1wiKTtcclxuICAgICAgdG9Eb0xpc3QuaW5uZXJIVE1MID0gbnVsbDtcclxuICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGN1cnJlbnRBcnJheS5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBjb25zdCBjYXJkID0gbmV3IFRvRG8oXHJcbiAgICAgICAgICBjdXJyZW50QXJyYXlbaW5kZXhdLnRpdGxlLFxyXG4gICAgICAgICAgY3VycmVudEFycmF5W2luZGV4XS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgIGN1cnJlbnRBcnJheVtpbmRleF0uZGF0ZSxcclxuICAgICAgICAgIGN1cnJlbnRBcnJheVtpbmRleF0ucHJpb3JpdHlcclxuICAgICAgICApO1xyXG4gICAgICAgIGlmIChjYXJkLmlkKSB7XHJcbiAgICAgICAgICBsZXQgcmVuZGVyQ2FyZCA9IGNhcmQucHJpbnQoKTtcclxuICAgICAgICAgIHRvRG9MaXN0U2hvdy5hcHBlbmRDaGlsZChyZW5kZXJDYXJkKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiLCBmb3JtLmNoaWxkcmVuWzBdLnZhbHVlKTtcclxuICAgIGxldCBrZXkgPSBmb3JtLmNoaWxkcmVuWzBdLnZhbHVlO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7a2V5fWAsIEpTT04uc3RyaW5naWZ5KFtdKSk7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRBcnJheVwiLCBcIltdXCIpO1xyXG4gICAgbGV0IHRvRG9MaXN0U2hvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9Eb0xpc3RTaG93XCIpO1xyXG4gICAgdG9Eb0xpc3RTaG93LmlubmVySFRNTCA9IG51bGw7XHJcbiAgICBsaS5hcHBlbmRDaGlsZChidXR0b24pO1xyXG4gICAgdUxpc3QuYXBwZW5kQ2hpbGQobGkpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RzKSk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBwcm9qZWN0TGlzdDtcclxufTtcclxuXHJcbmV4cG9ydCB7IHByb2plY3RMaXN0Q29tcG9uZW50IH07XHJcbiIsImltcG9ydCB7IFRvRG8gfSBmcm9tIFwiLi90b0RvXCI7XHJcblxyXG5sZXQgYWxsVG9Eb3MgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYWxsVG9Eb3NBcnJheVwiKSk7XHJcbmFsbFRvRG9zID8/PSBbXTtcclxuXHJcbmNvbnN0IGZvcm0gPSAoKSA9PiB7XHJcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xyXG4gIGNvbnN0IGlucHV0VGl0bGVOTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXRUaXRsZU5MYWJlbCk7XHJcbiAgbGV0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gIGxhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcInRpdGxlXCIpO1xyXG4gIGxhYmVsLmlubmVySFRNTCA9IFwiVGl0bGU6XCI7XHJcbiAgaW5wdXRUaXRsZU5MYWJlbC5hcHBlbmRDaGlsZChsYWJlbCk7XHJcblxyXG4gIGxldCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dFwiKTtcclxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwidGl0bGVcIik7XHJcbiAgaW5wdXQuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJ0aXRsZVwiKTtcclxuICBpbnB1dFRpdGxlTkxhYmVsLmFwcGVuZENoaWxkKGlucHV0KTtcclxuXHJcbiAgY29uc3QgaW5wdXREZXNjcmlwdGlvbk5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dERlc2NyaXB0aW9uTkxhYmVsKTtcclxuICBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICBsYWJlbC5pbm5lckhUTUwgPSBcIkRlc2NyaXB0aW9uOlwiO1xyXG4gIGxhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcImRlc2NyaXB0aW9uXCIpO1xyXG4gIGlucHV0RGVzY3JpcHRpb25OTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xyXG5cclxuICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dFwiKTtcclxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwiZGVzY3JpcHRpb25cIik7XHJcbiAgaW5wdXQuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJkZXNjcmlwdGlvblwiKTtcclxuICBpbnB1dERlc2NyaXB0aW9uTkxhYmVsLmFwcGVuZENoaWxkKGlucHV0KTtcclxuXHJcbiAgY29uc3QgaW5wdXREdWVEYXRlTkxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICBmb3JtLmFwcGVuZENoaWxkKGlucHV0RHVlRGF0ZU5MYWJlbCk7XHJcbiAgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgbGFiZWwuaW5uZXJIVE1MID0gXCJEdWUgRGF0ZTogXCI7XHJcbiAgbGFiZWwuc2V0QXR0cmlidXRlKFwiZm9yXCIsIFwiZHVlRGF0ZVwiKTtcclxuICBpbnB1dER1ZURhdGVOTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xyXG5cclxuICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiZGF0ZVwiKTtcclxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwiZHVlRGF0ZVwiKTtcclxuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImR1ZURhdGVcIik7XHJcbiAgaW5wdXREdWVEYXRlTkxhYmVsLmFwcGVuZENoaWxkKGlucHV0KTtcclxuXHJcbiAgY29uc3QgaW5wdXRQcmlvcml0eU5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dFByaW9yaXR5TkxhYmVsKTtcclxuICBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICBsYWJlbC5pbm5lckhUTUwgPSBcIlByaW9yaXR5OlwiO1xyXG4gIGxhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcInByaW9yaXR5XCIpO1xyXG4gIGlucHV0UHJpb3JpdHlOTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xyXG5cclxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgMzsgaW5kZXgrKykge1xyXG4gICAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICBsZXQgcHJpb3JpdHk7XHJcbiAgICBzd2l0Y2ggKGluZGV4KSB7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICBwcmlvcml0eSA9IFwibG93XCI7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIDE6XHJcbiAgICAgICAgcHJpb3JpdHkgPSBcIm1lZGl1bVwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDI6XHJcbiAgICAgICAgcHJpb3JpdHkgPSBcInVyZ2VudFwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcbiAgICBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICAgIGxhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBwcmlvcml0eSk7XHJcbiAgICBsYWJlbC5pbm5lckhUTUwgPSBwcmlvcml0eTtcclxuICAgIGlucHV0UHJpb3JpdHlOTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xyXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInJhZGlvXCIpO1xyXG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBwcmlvcml0eSk7XHJcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBwcmlvcml0eSk7XHJcbiAgICBpbnB1dFByaW9yaXR5TkxhYmVsLmFwcGVuZENoaWxkKGlucHV0KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHN1bWJpdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICBmb3JtLmFwcGVuZENoaWxkKHN1bWJpdEJ1dHRvbik7XHJcbiAgc3VtYml0QnV0dG9uLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJzdWJtaXRcIik7XHJcbiAgc3VtYml0QnV0dG9uLnNldEF0dHJpYnV0ZShcImlkXCIsIFwic3VibWl0QnV0dG9uXCIpO1xyXG4gIHJldHVybiBmb3JtO1xyXG59O1xyXG5cclxuY29uc3QgdG9Eb0NvbGxlY3Rpb24gPSAoKSA9PiB7XHJcbiAgY29uc3QgdG9Eb0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvRG9MaXN0XCIpO1xyXG5cclxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMlwiKTtcclxuICB0aXRsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRleHQtY2VudGVyXCIpO1xyXG4gIHRpdGxlLmlubmVySFRNTCA9IFwiTGlzdCBvZiBUb0RvXCI7XHJcblxyXG4gIHRvRG9MaXN0LmFwcGVuZENoaWxkKHRpdGxlKTtcclxuXHJcbiAgY29uc3QgdG9Eb0xpc3RCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgdG9Eb0xpc3RCbG9jay5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRvRG9MaXN0QmxvY2tcIik7XHJcblxyXG4gIHRvRG9MaXN0QmxvY2suYXBwZW5kQ2hpbGQoZm9ybSgpKTtcclxuICB0b0RvTGlzdC5hcHBlbmRDaGlsZCh0b0RvTGlzdEJsb2NrKTtcclxuXHJcbiAgY29uc3QgdG9Eb0xpc3RTaG93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICB0b0RvTGlzdFNob3cuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJ0b0RvTGlzdFNob3dcIik7XHJcbiAgdG9Eb0xpc3QuYXBwZW5kQ2hpbGQodG9Eb0xpc3RTaG93KTtcclxuICBsZXQgY3VycmVudFByb2plY3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIpO1xyXG4gIGNvbnN0IGFycmF5QXV4ID1cclxuICAgIGN1cnJlbnRQcm9qZWN0ID09IFwiRGVmYXVsdFwiXHJcbiAgICAgID8gYWxsVG9Eb3NcclxuICAgICAgOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGN1cnJlbnRQcm9qZWN0KSk7XHJcblxyXG4gIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhcnJheUF1eC5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgIGNvbnN0IGNhcmQgPSBuZXcgVG9EbyhcclxuICAgICAgYXJyYXlBdXhbaW5kZXhdLnRpdGxlLFxyXG4gICAgICBhcnJheUF1eFtpbmRleF0uZGVzY3JpcHRpb24sXHJcbiAgICAgIGFycmF5QXV4W2luZGV4XS5kYXRlLFxyXG4gICAgICBhcnJheUF1eFtpbmRleF0ucHJpb3JpdHlcclxuICAgICk7XHJcbiAgICBpZiAoY2FyZC50aXRsZSkge1xyXG4gICAgICBsZXQgcmVuZGVyQ2FyZCA9IGNhcmQucHJpbnQoKTtcclxuICAgICAgdG9Eb0xpc3RTaG93LmFwcGVuZENoaWxkKHJlbmRlckNhcmQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRvRG9MaXN0O1xyXG59O1xyXG5cclxuZXhwb3J0IHsgdG9Eb0NvbGxlY3Rpb24sIGFsbFRvRG9zIH07XHJcbiIsImltcG9ydCB7IHByb2plY3RMaXN0Q29tcG9uZW50IH0gZnJvbSBcIi4vcHJvamVjdHNcIjtcclxuaW1wb3J0IHsgdG9Eb0NvbGxlY3Rpb24sIGFsbFRvRG9zIH0gZnJvbSBcIi4vdG9Eb0NvbGxlY3Rpb25cIjtcclxuaW1wb3J0IHsgVG9EbyB9IGZyb20gXCIuL3RvRG9cIjtcclxuXHJcbmxldCBjdXJyZW50QWNjID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJhY2NUb0RvXCIpO1xyXG5jdXJyZW50QWNjID8/PSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImFjY1RvRG9cIiwgMCk7XHJcbmxldCBjdXJyZW50UHJvamVjdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFByb2plY3RcIik7XHJcbmN1cnJlbnRQcm9qZWN0ID8/PSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIFwiRGVmYXVsdFwiKTtcclxubGV0IGRlZlByb2plY3QgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiRGVmYXVsdFwiKSk7XHJcbmlmIChkZWZQcm9qZWN0ID09IG51bGwpIHtcclxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIkRlZmF1bHRcIiwgXCJbXVwiKTtcclxufVxyXG5cclxubGV0IGN1cnJlbnRBcnJheSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJEZWZhdWx0XCIpKTtcclxuY3VycmVudEFycmF5ID8/PSBbXTtcclxubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50QXJyYXlcIiwgSlNPTi5zdHJpbmdpZnkoY3VycmVudEFycmF5KSk7XHJcblxyXG5jb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250ZW50XCIpO1xyXG5cclxuY29uc3QgcHRMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuXHJcbnB0TGlzdC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNvbC00XCIpO1xyXG5wdExpc3Quc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwcm9qZWN0TGlzdFwiKTtcclxuY29udGVudC5hcHBlbmRDaGlsZChwdExpc3QpO1xyXG5cclxuY29uc3QgdG9MaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxudG9MaXN0LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY29sLThcIik7XHJcbnRvTGlzdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInRvRG9MaXN0XCIpO1xyXG5jb250ZW50LmFwcGVuZENoaWxkKHRvTGlzdCk7XHJcblxyXG5sZXQgcHJvamVjdExpc3QgPSBwcm9qZWN0TGlzdENvbXBvbmVudCgpO1xyXG5cclxuY29udGVudC5hcHBlbmRDaGlsZChwcm9qZWN0TGlzdCk7XHJcblxyXG5jb25zdCB0b0RvTGlzdCA9IHRvRG9Db2xsZWN0aW9uKCk7XHJcbmNvbnRlbnQuYXBwZW5kQ2hpbGQodG9Eb0xpc3QpO1xyXG5cclxuY29uc3QgZ2V0VGl0bGUgPSAoKSA9PiB7XHJcbiAgbGV0IHRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aXRsZVwiKTtcclxuICByZXR1cm4gdGl0bGUudmFsdWU7XHJcbn07XHJcblxyXG5jb25zdCBnZXREZXNjcmlwdGlvbiA9ICgpID0+IHtcclxuICBsZXQgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlc2NyaXB0aW9uXCIpO1xyXG4gIHJldHVybiBkZXNjcmlwdGlvbi52YWx1ZTtcclxufTtcclxuXHJcbmNvbnN0IGdldERhdGUgPSAoKSA9PiB7XHJcbiAgbGV0IGRhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImR1ZURhdGVcIik7XHJcbiAgcmV0dXJuIGRhdGUudmFsdWU7XHJcbn07XHJcblxyXG5jb25zdCBnZXRQcmlvcml0eSA9ICgpID0+IHtcclxuICBsZXQgcHJpb3JpdHlMb3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvd1wiKTtcclxuICBsZXQgcHJpb3JpdHlNZWRpdW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1lZGl1bVwiKTtcclxuICBsZXQgcHJpb3JpdHlVcmdlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVyZ2VudFwiKTtcclxuICBsZXQgcHJpb3JpdHkgPSBudWxsO1xyXG4gIGlmIChwcmlvcml0eUxvdy5jaGVja2VkKSB7XHJcbiAgICBwcmlvcml0eSA9IHByaW9yaXR5TG93Lm5hbWU7XHJcbiAgfSBlbHNlIGlmIChwcmlvcml0eU1lZGl1bS5jaGVja2VkKSB7XHJcbiAgICBwcmlvcml0eSA9IHByaW9yaXR5TWVkaXVtLm5hbWU7XHJcbiAgfSBlbHNlIHtcclxuICAgIHByaW9yaXR5ID0gcHJpb3JpdHlVcmdlbnQubmFtZTtcclxuICB9XHJcbiAgcmV0dXJuIHByaW9yaXR5O1xyXG59O1xyXG5cclxuY29uc3Qgb25TdWJtaXRGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdWJtaXRCdXR0b25cIik7XHJcbm9uU3VibWl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgbGV0IHRpdGxlID0gZ2V0VGl0bGUoKTtcclxuICBsZXQgZGVzYyA9IGdldERlc2NyaXB0aW9uKCk7XHJcbiAgbGV0IGRhdGUgPSBnZXREYXRlKCk7XHJcbiAgbGV0IHByaW9yID0gZ2V0UHJpb3JpdHkoKTtcclxuXHJcbiAgbGV0IHRvRG8gPSBuZXcgVG9Ebyh0aXRsZSwgZGVzYywgZGF0ZSwgcHJpb3IpO1xyXG4gIHRvRG9MaXN0U2hvdy5hcHBlbmRDaGlsZCh0b0RvLnByaW50KCkpO1xyXG4gIGFsbFRvRG9zLnB1c2godG9Ebyk7XHJcbiAgY3VycmVudEFycmF5ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRBcnJheVwiKSk7XHJcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJEZWZhdWx0XCIsIEpTT04uc3RyaW5naWZ5KGFsbFRvRG9zKSk7XHJcbiAgY3VycmVudEFycmF5LnB1c2godG9Ebyk7XHJcbiAgY3VycmVudFByb2plY3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIpO1xyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudEFycmF5XCIsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRBcnJheSkpO1xyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGAke2N1cnJlbnRQcm9qZWN0fWAsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRBcnJheSkpO1xyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWxsVG9Eb3NBcnJheVwiLCBKU09OLnN0cmluZ2lmeShhbGxUb0RvcykpO1xyXG4gIHRvRG9MaXN0LmFwcGVuZENoaWxkKHRvRG9MaXN0U2hvdyk7XHJcbn0pO1xyXG4iXSwic291cmNlUm9vdCI6IiJ9