(()=>{"use strict";const t=class{constructor(t,e,r,n,l){if(this.title=t,this.description=e,this.date=r,this.priority=n,l)this.id=l;else{let t=localStorage.getItem("accToDo");t=Number(t),t+=1,this.id=t,localStorage.setItem("accToDo",t)}}removeElement(){const t=JSON.parse(localStorage.getItem("Default")),e=JSON.parse(localStorage.getItem("currentArray")),r=t=>t.id===this.id,n=t.findIndex(r),l=e.findIndex(r);t.splice(n,1),localStorage.setItem("Default",JSON.stringify(t)),e.splice(l,1);const o=localStorage.getItem("currentProject");localStorage.setItem(o,JSON.stringify(e)),localStorage.setItem("currentArray",e);const i=document.getElementById(`${this.id}`);document.getElementById("toDoListShow").removeChild(i)}print(){const t=document.createElement("div");let e=null;e="low"===this.priority?"primary":"medium"===this.priority?"warning":"danger",t.setAttribute("class",`card text-white bg-${e}`),t.setAttribute("id",`${this.id}`);const r=document.createElement("div");r.setAttribute("class","card-header text-white"),r.innerHTML=this.title,t.appendChild(r);const n=document.createElement("div");n.setAttribute("class","card-body text-white"),t.appendChild(n);const l=document.createElement("h5");l.setAttribute("class","card-title text-white"),l.innerHTML=this.description,n.appendChild(l);let o=document.createElement("p");o.setAttribute("class","card-text text-white"),o.innerHTML=this.date,n.appendChild(o),o=document.createElement("p"),o.setAttribute("class","card-text text-white"),o.innerHTML=this.priority,n.appendChild(o);const i=document.createElement("div");i.setAttribute("class","row container"),t.appendChild(i);const c=document.createElement("button");return c.setAttribute("id","deleteButton"),c.setAttribute("class","col-2"),c.innerHTML="Delete",i.appendChild(c),c.addEventListener("click",(()=>this.removeElement())),t}};let e=JSON.parse(localStorage.getItem("projectsArray"));e=e||["Default"],localStorage.setItem("projectsArray",JSON.stringify(e));let r=localStorage.getItem("currentProject");r??=localStorage.setItem("currentProject","Default");let n=JSON.parse(localStorage.getItem(`${r}`));localStorage.setItem("currentArray",JSON.stringify(n));let l=JSON.parse(localStorage.getItem("allToDosArray"));l??=[],localStorage.setItem("allToDosArray",JSON.stringify(l)),null==localStorage.getItem("accToDo")&&localStorage.setItem("accToDo",0);let o=localStorage.getItem("currentProject");o??=localStorage.setItem("currentProject","Default"),null==JSON.parse(localStorage.getItem("Default"))&&localStorage.setItem("Default",JSON.stringify([]));let i=JSON.parse(localStorage.getItem(`${o}`));localStorage.setItem("currentArray",JSON.stringify(i));const c=document.getElementById("content"),a=document.createElement("div");a.setAttribute("class","col-4"),a.setAttribute("id","projectList"),c.appendChild(a);const d=document.createElement("div");d.setAttribute("class","col-8"),d.setAttribute("id","toDoList"),c.appendChild(d);const s=(()=>{const l=document.getElementById("projectList"),o=document.createElement("div");o.setAttribute("class","row");const i=document.createElement("h1");i.setAttribute("class","col-8"),i.innerHTML="Projects",o.appendChild(i);const c=(()=>{const t=document.createElement("form");t.setAttribute("id","idForm");const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("placeholder","Project name"),e.setAttribute("id","nameField"),t.appendChild(e);const r=document.createElement("span");r.setAttribute("class","col-4");const n=document.createElement("button");return n.setAttribute("type","submit"),n.setAttribute("id","buttonSubmit"),n.innerHTML="Add project",r.appendChild(n),t.appendChild(r),t})();o.appendChild(c);const a=document.createElement("ul");for(let l=0;l<e.length;l+=1){const o=document.createElement("li"),i=document.createElement("button");i.innerHTML=e[l],i.addEventListener("click",(e=>{localStorage.setItem("currentProject",e.target.innerHTML);const r=e.target.innerHTML,n=localStorage.getItem(r),l=JSON.parse(`${n}`);localStorage.setItem("currentArray",JSON.stringify(l));const o=document.getElementById("toDoListShow");o.innerHTML=null;const i="Default"===localStorage.getItem("currentProject")?JSON.parse(localStorage.getItem("Default")):JSON.parse(localStorage.getItem("currentArray"));for(let e=0;e<i.length;e+=1){const r=new t(i[e].title,i[e].description,i[e].date,i[e].priority,i[e].id);if(r.id){const t=r.print();o.appendChild(t),document.getElementById("toDoList").appendChild(o)}}})),o.appendChild(i),a.appendChild(o),n=JSON.parse(localStorage.getItem(r))}return l.appendChild(o),l.appendChild(a),c.children[1].children[0].addEventListener("click",(()=>{e.push(c.children[0].value);const r=document.createElement("li"),l=document.createElement("button");l.innerHTML=c.children[0].value,l.addEventListener("click",(e=>{localStorage.setItem("currentProject",e.target.innerHTML);const r=localStorage.getItem("currentProject");n=JSON.parse(localStorage.getItem(r)),localStorage.setItem("currentArray",JSON.stringify(n)),document.getElementById("toDoListShow").innerHTML=null;for(let e=0;e<n.length;e+=1){const r=new t(n[e].title,n[e].description,n[e].date,n[e].priority,n[e].id);if(r.id){const t=r.print();document.getElementById("toDoListShow").appendChild(t)}}})),localStorage.setItem("currentProject",c.children[0].value);const o=c.children[0].value;localStorage.setItem(`${o}`,JSON.stringify([])),localStorage.setItem("currentArray",JSON.stringify([])),document.getElementById("toDoListShow").innerHTML=null,r.appendChild(l),a.appendChild(r),localStorage.setItem("projectsArray",JSON.stringify(e))})),l})();c.appendChild(s);const m=(()=>{const e=document.getElementById("toDoList"),r=document.createElement("h2");r.setAttribute("class","text-center"),r.innerHTML="List of ToDo",e.appendChild(r);const n=document.createElement("div");n.setAttribute("class","toDoListBlock"),n.appendChild((()=>{const t=document.createElement("form"),e=document.createElement("div");t.appendChild(e);let r=document.createElement("label");r.setAttribute("for","title"),r.innerHTML="Title:",e.appendChild(r);let n=document.createElement("input");n.setAttribute("type","text"),n.setAttribute("name","title"),n.setAttribute("id","title"),e.appendChild(n);const l=document.createElement("div");t.appendChild(l),r=document.createElement("label"),r.innerHTML="Description:",r.setAttribute("for","description"),l.appendChild(r),n=document.createElement("input"),n.setAttribute("type","text"),n.setAttribute("name","description"),n.setAttribute("id","description"),l.appendChild(n);const o=document.createElement("div");t.appendChild(o),r=document.createElement("label"),r.innerHTML="Due Date: ",r.setAttribute("for","dueDate"),o.appendChild(r),n=document.createElement("input"),n.setAttribute("type","date"),n.setAttribute("name","dueDate"),n.setAttribute("id","dueDate"),o.appendChild(n);const i=document.createElement("div");t.appendChild(i),r=document.createElement("label"),r.innerHTML="Priority:",r.setAttribute("for","priority"),i.appendChild(r);for(let t=0;t<3;t+=1){let e;switch(n=document.createElement("input"),t){case 0:e="low";break;case 1:e="medium";break;case 2:e="urgent"}r=document.createElement("label"),r.setAttribute("for",e),r.innerHTML=e,i.appendChild(r),n.setAttribute("type","radio"),n.setAttribute("name",e),n.setAttribute("id",e),i.appendChild(n)}const c=document.createElement("input");return t.appendChild(c),c.setAttribute("type","submit"),c.setAttribute("id","submitButton"),t})()),e.appendChild(n);const l=document.createElement("div");l.setAttribute("id","toDoListShow"),e.appendChild(l);const o=localStorage.getItem("currentProject"),i="Default"===o?JSON.parse(localStorage.getItem("Default")):JSON.parse(localStorage.getItem(`${o}`));console.log(JSON.parse(localStorage.getItem(`${o}`)));for(let e=0;e<i.length;e+=1){const r=new t(i[e].title,i[e].description,i[e].date,i[e].priority,i[e].id);if(r.id){const t=r.print();l.appendChild(t)}}return e})();c.appendChild(m),document.getElementById("submitButton").addEventListener("click",(e=>{e.preventDefault();const r=document.getElementById("title").value,n=document.getElementById("description").value,c=document.getElementById("dueDate").value,a=(()=>{const t=document.getElementById("low"),e=document.getElementById("medium"),r=document.getElementById("urgent");let n=null;return n=t.checked?t.name:e.checked?e.name:r.name,n})(),d=new t(r,n,c,a),s=document.getElementById("toDoListShow");s.appendChild(d.print()),l.push(d),i=JSON.parse(localStorage.getItem("currentArray")),localStorage.setItem("Default",JSON.stringify(l)),i.push(d),o=localStorage.getItem("currentProject"),localStorage.setItem("currentArray",JSON.stringify(i)),localStorage.setItem(`${o}`,JSON.stringify(i)),localStorage.setItem("allToDosArray",JSON.stringify(l)),m.appendChild(s)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYWRkQnV0dG9uLmpzIiwid2VicGFjazovLy8uL3NyYy90b0RvLmpzIiwid2VicGFjazovLy8uL3NyYy9wcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RvRG9Db2xsZWN0aW9uLmpzIl0sIm5hbWVzIjpbInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkYXRlIiwicHJpb3JpdHkiLCJpZCIsInRoaXMiLCJhY2MiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiTnVtYmVyIiwic2V0SXRlbSIsImFycmF5RGVmYXVsdCIsIkpTT04iLCJwYXJzZSIsImN1cnJlbnRBcnJheSIsImZpbmRCeUlkIiwiZWxlbWVudCIsImluZGV4RGVmYXVsdCIsImZpbmRJbmRleCIsImluZGV4Q0EiLCJzcGxpY2UiLCJzdHJpbmdpZnkiLCJjdXJyZW50UHJvamVjdCIsImNhcmRUb1JlbW92ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW1vdmVDaGlsZCIsImNhcmQiLCJjcmVhdGVFbGVtZW50IiwiY29sb3IiLCJzZXRBdHRyaWJ1dGUiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImJvZHkiLCJib2R5VGl0bGUiLCJib2R5UCIsImtleXBhZCIsImRlbEJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFbGVtZW50IiwicHJvamVjdHMiLCJjdXJyZW50UCIsImFycmF5Q3VycmVudCIsImFsbFRvRG9zIiwiY29udGVudCIsInB0TGlzdCIsInRvTGlzdCIsInByb2plY3RMaXN0IiwiZGl2UHJvamVjdHNCdXR0b24iLCJmb3JtIiwiaW5wdXROYW1lIiwic3BhbkFkZEJ1dHRvbiIsImFkZEJ1dHRvbiIsInVMaXN0IiwiaW5kZXgiLCJsZW5ndGgiLCJsaSIsImJ1dHRvbiIsImUiLCJ0YXJnZXQiLCJ0YXJnZXRWYWx1ZSIsImdldFZhbHVlIiwibGlzdCIsImFycmF5QXV4IiwicmVuZGVyQ2FyZCIsInByaW50IiwiY2hpbGRyZW4iLCJwdXNoIiwidmFsdWUiLCJpdGVtIiwia2V5IiwidG9Eb0xpc3QiLCJ0b0RvTGlzdEJsb2NrIiwiaW5wdXRUaXRsZU5MYWJlbCIsImxhYmVsIiwiaW5wdXQiLCJpbnB1dERlc2NyaXB0aW9uTkxhYmVsIiwiaW5wdXREdWVEYXRlTkxhYmVsIiwiaW5wdXRQcmlvcml0eU5MYWJlbCIsInN1bWJpdEJ1dHRvbiIsInRvRG9MaXN0U2hvdyIsImNvbnNvbGUiLCJsb2ciLCJwcmV2ZW50RGVmYXVsdCIsImRlc2MiLCJwcmlvciIsInByaW9yaXR5TG93IiwicHJpb3JpdHlNZWRpdW0iLCJwcmlvcml0eVVyZ2VudCIsImNoZWNrZWQiLCJuYW1lIiwiZ2V0UHJpb3JpdHkiLCJ0b0RvIl0sIm1hcHBpbmdzIjoibUJBQUEsTUN5RkEsRUF6RkEsTUFDRSxZQUFZQSxFQUFPQyxFQUFhQyxFQUFNQyxFQUFVQyxHQUs5QyxHQUpBQyxLQUFLTCxNQUFRQSxFQUNiSyxLQUFLSixZQUFjQSxFQUNuQkksS0FBS0gsS0FBT0EsRUFDWkcsS0FBS0YsU0FBV0EsRUFDWkMsRUFDRkMsS0FBS0QsR0FBS0EsTUFDTCxDQUNMLElBQUlFLEVBQU1DLGFBQWFDLFFBQVEsV0FDL0JGLEVBQU1HLE9BQU9ILEdBQ2JBLEdBQU8sRUFDUEQsS0FBS0QsR0FBS0UsRUFDVkMsYUFBYUcsUUFBUSxVQUFXSixJQUlwQyxnQkFDRSxNQUFNSyxFQUFlQyxLQUFLQyxNQUFNTixhQUFhQyxRQUFRLFlBQy9DTSxFQUFlRixLQUFLQyxNQUFNTixhQUFhQyxRQUFRLGlCQUMvQ08sRUFBWUMsR0FBWUEsRUFBUVosS0FBT0MsS0FBS0QsR0FDNUNhLEVBQWVOLEVBQWFPLFVBQVVILEdBQ3RDSSxFQUFVTCxFQUFhSSxVQUFVSCxHQUN2Q0osRUFBYVMsT0FBT0gsRUFBYyxHQUNsQ1YsYUFBYUcsUUFBUSxVQUFXRSxLQUFLUyxVQUFVVixJQUUvQ0csRUFBYU0sT0FBT0QsRUFBUyxHQUM3QixNQUFNRyxFQUFpQmYsYUFB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TUFBTU4sYUFBYUMsUUFBUSxpQkFDL0NELGFBQWFHLFFBQVEsVUFBV0UsS0FBS1MsVUFBVXNCLElBQy9DN0IsRUFBYXFELEtBQUt5QixHQUNsQnRFLEVBQWlCZixhQUFhQyxRQUFRLGtCQUN0Q0QsYUFBYUcsUUFBUSxlQUFnQkUsS0FBS1MsVUFBVVAsSUFDcERQLGFBQWFHLFFBQVEsR0FBR1ksSUFBa0JWLEtBQUtTLFVBQVVQLElBQ3pEUCxhQUFhRyxRQUFRLGdCQUFpQkUsS0FBS1MsVUFBVXNCLElBQ3JENEIsRUFBU3ZDLFlBQVlnRCxPIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBhZGRCdXR0b25Db21wb25lbnQgPSAoKSA9PiB7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XG4gIGZvcm0uc2V0QXR0cmlidXRlKCdpZCcsICdpZEZvcm0nKTtcbiAgY29uc3QgaW5wdXROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgaW5wdXROYW1lLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0Jyk7XG4gIGlucHV0TmFtZS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJywgJ1Byb2plY3QgbmFtZScpO1xuICBpbnB1dE5hbWUuc2V0QXR0cmlidXRlKCdpZCcsICduYW1lRmllbGQnKTtcbiAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dE5hbWUpO1xuICBjb25zdCBzcGFuQWRkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICBzcGFuQWRkQnV0dG9uLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnY29sLTQnKTtcbiAgY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gIGFkZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnc3VibWl0Jyk7XG4gIGFkZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2J1dHRvblN1Ym1pdCcpO1xuICBhZGRCdXR0b24uaW5uZXJIVE1MID0gJ0FkZCBwcm9qZWN0JztcblxuICBzcGFuQWRkQnV0dG9uLmFwcGVuZENoaWxkKGFkZEJ1dHRvbik7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoc3BhbkFkZEJ1dHRvbik7XG5cbiAgcmV0dXJuIGZvcm07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBhZGRCdXR0b25Db21wb25lbnQ7XG4iLCJjbGFzcyBUb0RvIHtcbiAgY29uc3RydWN0b3IodGl0bGUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSwgaWQpIHtcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgIHRoaXMuZGF0ZSA9IGRhdGU7XG4gICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgIGlmIChpZCkge1xuICAgICAgdGhpcy5pZCA9IGlkO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgYWNjID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY1RvRG8nKTtcbiAgICAgIGFjYyA9IE51bWJlcihhY2MpO1xuICAgICAgYWNjICs9IDE7XG4gICAgICB0aGlzLmlkID0gYWNjO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjY1RvRG8nLCBhY2MpO1xuICAgIH1cbiAgfVxuXG4gIHJlbW92ZUVsZW1lbnQoKSB7XG4gICAgY29uc3QgYXJyYXlEZWZhdWx0ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnRGVmYXVsdCcpKTtcbiAgICBjb25zdCBjdXJyZW50QXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50QXJyYXknKSk7XG4gICAgY29uc3QgZmluZEJ5SWQgPSAoZWxlbWVudCkgPT4gZWxlbWVudC5pZCA9PT0gdGhpcy5pZDtcbiAgICBjb25zdCBpbmRleERlZmF1bHQgPSBhcnJheURlZmF1bHQuZmluZEluZGV4KGZpbmRCeUlkKTtcbiAgICBjb25zdCBpbmRleENBID0gY3VycmVudEFycmF5LmZpbmRJbmRleChmaW5kQnlJZCk7XG4gICAgYXJyYXlEZWZhdWx0LnNwbGljZShpbmRleERlZmF1bHQsIDEpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdEZWZhdWx0JywgSlNPTi5zdHJpbmdpZnkoYXJyYXlEZWZhdWx0KSk7XG5cbiAgICBjdXJyZW50QXJyYXkuc3BsaWNlKGluZGV4Q0EsIDEpO1xuICAgIGNvbnN0IGN1cnJlbnRQcm9qZWN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRQcm9qZWN0Jyk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY3VycmVudFByb2plY3QsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRBcnJheSkpO1xuXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2N1cnJlbnRBcnJheScsIGN1cnJlbnRBcnJheSk7XG5cbiAgICBjb25zdCBjYXJkVG9SZW1vdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLmlkfWApO1xuICAgIGNvbnN0IHNob3dUb0RvTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b0RvTGlzdFNob3cnKTtcbiAgICBzaG93VG9Eb0xpc3QucmVtb3ZlQ2hpbGQoY2FyZFRvUmVtb3ZlKTtcbiAgfVxuXG4gIHByaW50KCkge1xuICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBsZXQgY29sb3IgPSBudWxsO1xuICAgIGlmICh0aGlzLnByaW9yaXR5ID09PSAnbG93Jykge1xuICAgICAgY29sb3IgPSAncHJpbWFyeSc7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByaW9yaXR5ID09PSAnbWVkaXVtJykge1xuICAgICAgY29sb3IgPSAnd2FybmluZyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbG9yID0gJ2Rhbmdlcic7XG4gICAgfVxuICAgIGNhcmQuc2V0QXR0cmlidXRlKCdjbGFzcycsIGBjYXJkIHRleHQtd2hpdGUgYmctJHtjb2xvcn1gKTtcbiAgICBjYXJkLnNldEF0dHJpYnV0ZSgnaWQnLCBgJHt0aGlzLmlkfWApO1xuXG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aXRsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2NhcmQtaGVhZGVyIHRleHQtd2hpdGUnKTtcbiAgICB0aXRsZS5pbm5lckhUTUwgPSB0aGlzLnRpdGxlO1xuICAgIGNhcmQuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG4gICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGJvZHkuc2V0QXR0cmlidXRlKCdjbGFzcycsICdjYXJkLWJvZHkgdGV4dC13aGl0ZScpO1xuICAgIGNhcmQuYXBwZW5kQ2hpbGQoYm9keSk7XG5cbiAgICBjb25zdCBib2R5VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoNScpO1xuICAgIGJvZHlUaXRsZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2NhcmQtdGl0bGUgdGV4dC13aGl0ZScpO1xuICAgIGJvZHlUaXRsZS5pbm5lckhUTUwgPSB0aGlzLmRlc2NyaXB0aW9uO1xuICAgIGJvZHkuYXBwZW5kQ2hpbGQoYm9keVRpdGxlKTtcblxuICAgIGxldCBib2R5UCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBib2R5UC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2NhcmQtdGV4dCB0ZXh0LXdoaXRlJyk7XG4gICAgYm9keVAuaW5uZXJIVE1MID0gdGhpcy5kYXRlO1xuICAgIGJvZHkuYXBwZW5kQ2hpbGQoYm9keVApO1xuXG4gICAgYm9keVAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgYm9keVAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdjYXJkLXRleHQgdGV4dC13aGl0ZScpO1xuICAgIGJvZHlQLmlubmVySFRNTCA9IHRoaXMucHJpb3JpdHk7XG4gICAgYm9keS5hcHBlbmRDaGlsZChib2R5UCk7XG5cbiAgICBjb25zdCBrZXlwYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBrZXlwYWQuc2V0QXR0cmlidXRlKCdjbGFzcycsICdyb3cgY29udGFpbmVyJyk7XG4gICAgY2FyZC5hcHBlbmRDaGlsZChrZXlwYWQpO1xuXG4gICAgY29uc3QgZGVsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZSgnaWQnLCAnZGVsZXRlQnV0dG9uJyk7XG4gICAgZGVsQnV0dG9uLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnY29sLTInKTtcbiAgICBkZWxCdXR0b24uaW5uZXJIVE1MID0gJ0RlbGV0ZSc7XG4gICAga2V5cGFkLmFwcGVuZENoaWxkKGRlbEJ1dHRvbik7XG4gICAgZGVsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5yZW1vdmVFbGVtZW50KCkpO1xuXG4gICAgcmV0dXJuIGNhcmQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVG9EbztcbiIsImltcG9ydCBhZGRCdXR0b25Db21wb25lbnQgZnJvbSBcIi4vYWRkQnV0dG9uXCI7XG5pbXBvcnQgVG9EbyBmcm9tIFwiLi90b0RvXCI7XG5cbmxldCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIpKTtcbnByb2plY3RzID0gIXByb2plY3RzID8gW1wiRGVmYXVsdFwiXSA6IHByb2plY3RzO1xubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c0FycmF5XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RzKSk7XG5cbmxldCBjdXJyZW50UCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFByb2plY3RcIik7XG5jdXJyZW50UCA/Pz0gbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiLCBcIkRlZmF1bHRcIik7XG5cbmxldCBhcnJheUN1cnJlbnQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGAke2N1cnJlbnRQfWApKTtcbmlmIChhcnJheUN1cnJlbnQgPT0gbnVsbCB8fCBhcnJheUN1cnJlbnQgPT0gW10pIHtcbiAgYXJyYXlDdXJyZW50ID09IFtdO1xufVxuXG5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRBcnJheVwiLCBKU09OLnN0cmluZ2lmeShhcnJheUN1cnJlbnQpKTtcblxuY29uc3QgcHJvamVjdExpc3RDb21wb25lbnQgPSAoKSA9PiB7XG4gIGNvbnN0IHByb2plY3RMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9qZWN0TGlzdFwiKTtcblxuICBjb25zdCBkaXZQcm9qZWN0c0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGRpdlByb2plY3RzQnV0dG9uLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwicm93XCIpO1xuXG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgxXCIpO1xuICB0aXRsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNvbC04XCIpO1xuICB0aXRsZS5pbm5lckhUTUwgPSBcIlByb2plY3RzXCI7XG4gIGRpdlByb2plY3RzQnV0dG9uLmFwcGVuZENoaWxkKHRpdGxlKTtcbiAgY29uc3QgZm9ybSA9IGFkZEJ1dHRvbkNvbXBvbmVudCgpO1xuICBkaXZQcm9qZWN0c0J1dHRvbi5hcHBlbmRDaGlsZChmb3JtKTtcblxuICBjb25zdCB1TGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ1bFwiKTtcblxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgcHJvamVjdHMubGVuZ3RoOyBpbmRleCArPSAxKSB7XG4gICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICBidXR0b24uaW5uZXJIVE1MID0gcHJvamVjdHNbaW5kZXhdO1xuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudFByb2plY3RcIiwgZS50YXJnZXQuaW5uZXJIVE1MKTtcbiAgICAgIGNvbnN0IHRhcmdldFZhbHVlID0gZS50YXJnZXQuaW5uZXJIVE1MO1xuICAgICAgY29uc3QgZ2V0VmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0YXJnZXRWYWx1ZSk7XG4gICAgICBjb25zdCBhcnJheUN1cnJlbnQgPSBKU09OLnBhcnNlKGAke2dldFZhbHVlfWApO1xuXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRBcnJheVwiLCBKU09OLnN0cmluZ2lmeShhcnJheUN1cnJlbnQpKTtcbiAgICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvRG9MaXN0U2hvd1wiKTtcblxuICAgICAgbGlzdC5pbm5lckhUTUwgPSBudWxsO1xuICAgICAgY29uc3QgY3VycmVudFAgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIpO1xuICAgICAgY29uc3QgYXJyYXlBdXggPVxuICAgICAgICBjdXJyZW50UCA9PT0gXCJEZWZhdWx0XCJcbiAgICAgICAgICA/IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJEZWZhdWx0XCIpKVxuICAgICAgICAgIDogSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRBcnJheVwiKSk7XG5cbiAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhcnJheUF1eC5sZW5ndGg7IGluZGV4ICs9IDEpIHtcbiAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBUb0RvKFxuICAgICAgICAgIGFycmF5QXV4W2luZGV4XS50aXRsZSxcbiAgICAgICAgICBhcnJheUF1eFtpbmRleF0uZGVzY3JpcHRpb24sXG4gICAgICAgICAgYXJyYXlBdXhbaW5kZXhdLmRhdGUsXG4gICAgICAgICAgYXJyYXlBdXhbaW5kZXhdLnByaW9yaXR5LFxuICAgICAgICAgIGFycmF5QXV4W2luZGV4XS5pZFxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChjYXJkLmlkKSB7XG4gICAgICAgICAgY29uc3QgcmVuZGVyQ2FyZCA9IGNhcmQucHJpbnQoKTtcbiAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKHJlbmRlckNhcmQpO1xuICAgICAgICAgIGNvbnN0IHRvTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9Eb0xpc3RcIik7XG4gICAgICAgICAgdG9MaXN0LmFwcGVuZENoaWxkKGxpc3QpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBsaS5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgIHVMaXN0LmFwcGVuZENoaWxkKGxpKTtcblxuICAgIGFycmF5Q3VycmVudCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oY3VycmVudFApKTtcbiAgfVxuXG4gIHByb2plY3RMaXN0LmFwcGVuZENoaWxkKGRpdlByb2plY3RzQnV0dG9uKTtcblxuICBwcm9qZWN0TGlzdC5hcHBlbmRDaGlsZCh1TGlzdCk7XG5cbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZm9ybS5jaGlsZHJlblsxXS5jaGlsZHJlblswXTtcbiAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJvamVjdHMucHVzaChmb3JtLmNoaWxkcmVuWzBdLnZhbHVlKTtcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcbiAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgIGJ1dHRvbi5pbm5lckhUTUwgPSBmb3JtLmNoaWxkcmVuWzBdLnZhbHVlO1xuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudFByb2plY3RcIiwgZS50YXJnZXQuaW5uZXJIVE1MKTtcbiAgICAgIGNvbnN0IGl0ZW0gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIpO1xuICAgICAgYXJyYXlDdXJyZW50ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShpdGVtKSk7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRBcnJheVwiLCBKU09OLnN0cmluZ2lmeShhcnJheUN1cnJlbnQpKTtcbiAgICAgIGNvbnN0IHRvRG9MID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0RvTGlzdFNob3dcIik7XG4gICAgICB0b0RvTC5pbm5lckhUTUwgPSBudWxsO1xuICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGFycmF5Q3VycmVudC5sZW5ndGg7IGluZGV4ICs9IDEpIHtcbiAgICAgICAgY29uc3QgY2FyZCA9IG5ldyBUb0RvKFxuICAgICAgICAgIGFycmF5Q3VycmVudFtpbmRleF0udGl0bGUsXG4gICAgICAgICAgYXJyYXlDdXJyZW50W2luZGV4XS5kZXNjcmlwdGlvbixcbiAgICAgICAgICBhcnJheUN1cnJlbnRbaW5kZXhdLmRhdGUsXG4gICAgICAgICAgYXJyYXlDdXJyZW50W2luZGV4XS5wcmlvcml0eSxcbiAgICAgICAgICBhcnJheUN1cnJlbnRbaW5kZXhdLmlkXG4gICAgICAgICk7XG4gICAgICAgIGlmIChjYXJkLmlkKSB7XG4gICAgICAgICAgY29uc3QgcmVuZGVyQ2FyZCA9IGNhcmQucHJpbnQoKTtcbiAgICAgICAgICBjb25zdCB0b0RvTGlzdFNob3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvRG9MaXN0U2hvd1wiKTtcbiAgICAgICAgICB0b0RvTGlzdFNob3cuYXBwZW5kQ2hpbGQocmVuZGVyQ2FyZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIGZvcm0uY2hpbGRyZW5bMF0udmFsdWUpO1xuICAgIGNvbnN0IGtleSA9IGZvcm0uY2hpbGRyZW5bMF0udmFsdWU7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7a2V5fWAsIEpTT04uc3RyaW5naWZ5KFtdKSk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjdXJyZW50QXJyYXlcIiwgSlNPTi5zdHJpbmdpZnkoW10pKTtcbiAgICBjb25zdCB0b0RvTGlzdFNob3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvRG9MaXN0U2hvd1wiKTtcbiAgICB0b0RvTGlzdFNob3cuaW5uZXJIVE1MID0gbnVsbDtcbiAgICBsaS5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgIHVMaXN0LmFwcGVuZENoaWxkKGxpKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RzQXJyYXlcIiwgSlNPTi5zdHJpbmdpZnkocHJvamVjdHMpKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHByb2plY3RMaXN0O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgcHJvamVjdExpc3RDb21wb25lbnQ7XG4iLCJpbXBvcnQgcHJvamVjdExpc3RDb21wb25lbnQgZnJvbSBcIi4vcHJvamVjdHNcIjtcbmltcG9ydCB0b0RvQ29sbGVjdGlvbiBmcm9tIFwiLi90b0RvQ29sbGVjdGlvblwiO1xuaW1wb3J0IFRvRG8gZnJvbSBcIi4vdG9Eb1wiO1xuXG5sZXQgYWxsVG9Eb3MgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYWxsVG9Eb3NBcnJheVwiKSk7XG5hbGxUb0RvcyA/Pz0gW107XG5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImFsbFRvRG9zQXJyYXlcIiwgSlNPTi5zdHJpbmdpZnkoYWxsVG9Eb3MpKTtcblxuY29uc3QgY3VycmVudEFjYyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYWNjVG9Eb1wiKTtcbmlmIChjdXJyZW50QWNjID09IG51bGwpIHtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJhY2NUb0RvXCIsIDApO1xufVxubGV0IGN1cnJlbnRQcm9qZWN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXJyZW50UHJvamVjdFwiKTtcbmN1cnJlbnRQcm9qZWN0ID8/PSBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIsIFwiRGVmYXVsdFwiKTtcblxuY29uc3QgZGVmUHJvamVjdCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJEZWZhdWx0XCIpKTtcbmlmIChkZWZQcm9qZWN0ID09IG51bGwpIHtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJEZWZhdWx0XCIsIEpTT04uc3RyaW5naWZ5KFtdKSk7XG59XG5cbmxldCBjdXJyZW50QXJyYXkgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGAke2N1cnJlbnRQcm9qZWN0fWApKTtcbmlmIChjdXJyZW50QXJyYXkgPT0gbnVsbCB8fCBjdXJyZW50QXJyYXkgPT0gW10pIHtcbiAgY3VycmVudEFycmF5ID09IFtdO1xufVxuXG5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRBcnJheVwiLCBKU09OLnN0cmluZ2lmeShjdXJyZW50QXJyYXkpKTtcblxuY29uc3QgY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGVudFwiKTtcblxuY29uc3QgcHRMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxucHRMaXN0LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY29sLTRcIik7XG5wdExpc3Quc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwcm9qZWN0TGlzdFwiKTtcbmNvbnRlbnQuYXBwZW5kQ2hpbGQocHRMaXN0KTtcblxuY29uc3QgdG9MaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbnRvTGlzdC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNvbC04XCIpO1xudG9MaXN0LnNldEF0dHJpYnV0ZShcImlkXCIsIFwidG9Eb0xpc3RcIik7XG5jb250ZW50LmFwcGVuZENoaWxkKHRvTGlzdCk7XG5cbmNvbnN0IHByb2plY3RMaXN0ID0gcHJvamVjdExpc3RDb21wb25lbnQoKTtcblxuY29udGVudC5hcHBlbmRDaGlsZChwcm9qZWN0TGlzdCk7XG5cbmNvbnN0IHRvRG9MaXN0ID0gdG9Eb0NvbGxlY3Rpb24oKTtcbmNvbnRlbnQuYXBwZW5kQ2hpbGQodG9Eb0xpc3QpO1xuXG5jb25zdCBnZXRUaXRsZSA9ICgpID0+IHtcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpdGxlXCIpO1xuICByZXR1cm4gdGl0bGUudmFsdWU7XG59O1xuXG5jb25zdCBnZXREZXNjcmlwdGlvbiA9ICgpID0+IHtcbiAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlc2NyaXB0aW9uXCIpO1xuICByZXR1cm4gZGVzY3JpcHRpb24udmFsdWU7XG59O1xuXG5jb25zdCBnZXREYXRlID0gKCkgPT4ge1xuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkdWVEYXRlXCIpO1xuICByZXR1cm4gZGF0ZS52YWx1ZTtcbn07XG5cbmNvbnN0IGdldFByaW9yaXR5ID0gKCkgPT4ge1xuICBjb25zdCBwcmlvcml0eUxvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG93XCIpO1xuICBjb25zdCBwcmlvcml0eU1lZGl1bSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVkaXVtXCIpO1xuICBjb25zdCBwcmlvcml0eVVyZ2VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidXJnZW50XCIpO1xuICBsZXQgcHJpb3JpdHkgPSBudWxsO1xuICBpZiAocHJpb3JpdHlMb3cuY2hlY2tlZCkge1xuICAgIHByaW9yaXR5ID0gcHJpb3JpdHlMb3cubmFtZTtcbiAgfSBlbHNlIGlmIChwcmlvcml0eU1lZGl1bS5jaGVja2VkKSB7XG4gICAgcHJpb3JpdHkgPSBwcmlvcml0eU1lZGl1bS5uYW1lO1xuICB9IGVsc2Uge1xuICAgIHByaW9yaXR5ID0gcHJpb3JpdHlVcmdlbnQubmFtZTtcbiAgfVxuICByZXR1cm4gcHJpb3JpdHk7XG59O1xuXG5jb25zdCBvblN1Ym1pdEZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN1Ym1pdEJ1dHRvblwiKTtcbm9uU3VibWl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCB0aXRsZSA9IGdldFRpdGxlKCk7XG4gIGNvbnN0IGRlc2MgPSBnZXREZXNjcmlwdGlvbigpO1xuICBjb25zdCBkYXRlID0gZ2V0RGF0ZSgpO1xuICBjb25zdCBwcmlvciA9IGdldFByaW9yaXR5KCk7XG5cbiAgY29uc3QgdG9EbyA9IG5ldyBUb0RvKHRpdGxlLCBkZXNjLCBkYXRlLCBwcmlvcik7XG4gIGNvbnN0IHRvRG9MaXN0U2hvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9Eb0xpc3RTaG93XCIpO1xuICB0b0RvTGlzdFNob3cuYXBwZW5kQ2hpbGQodG9Eby5wcmludCgpKTtcbiAgYWxsVG9Eb3MucHVzaCh0b0RvKTtcbiAgY3VycmVudEFycmF5ID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRBcnJheVwiKSk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiRGVmYXVsdFwiLCBKU09OLnN0cmluZ2lmeShhbGxUb0RvcykpO1xuICBjdXJyZW50QXJyYXkucHVzaCh0b0RvKTtcbiAgY3VycmVudFByb2plY3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1cnJlbnRQcm9qZWN0XCIpO1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1cnJlbnRBcnJheVwiLCBKU09OLnN0cmluZ2lmeShjdXJyZW50QXJyYXkpKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7Y3VycmVudFByb2plY3R9YCwgSlNPTi5zdHJpbmdpZnkoY3VycmVudEFycmF5KSk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYWxsVG9Eb3NBcnJheVwiLCBKU09OLnN0cmluZ2lmeShhbGxUb0RvcykpO1xuICB0b0RvTGlzdC5hcHBlbmRDaGlsZCh0b0RvTGlzdFNob3cpO1xufSk7XG4iLCJpbXBvcnQgVG9EbyBmcm9tIFwiLi90b0RvXCI7XG5cbmNvbnN0IGZvcm0gPSAoKSA9PiB7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTtcbiAgY29uc3QgaW5wdXRUaXRsZU5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXRUaXRsZU5MYWJlbCk7XG4gIGxldCBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcbiAgbGFiZWwuc2V0QXR0cmlidXRlKFwiZm9yXCIsIFwidGl0bGVcIik7XG4gIGxhYmVsLmlubmVySFRNTCA9IFwiVGl0bGU6XCI7XG4gIGlucHV0VGl0bGVOTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xuXG4gIGxldCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgaW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInRleHRcIik7XG4gIGlucHV0LnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJ0aXRsZVwiKTtcbiAgaW5wdXQuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJ0aXRsZVwiKTtcbiAgaW5wdXRUaXRsZU5MYWJlbC5hcHBlbmRDaGlsZChpbnB1dCk7XG5cbiAgY29uc3QgaW5wdXREZXNjcmlwdGlvbk5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXREZXNjcmlwdGlvbk5MYWJlbCk7XG4gIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xuICBsYWJlbC5pbm5lckhUTUwgPSBcIkRlc2NyaXB0aW9uOlwiO1xuICBsYWJlbC5zZXRBdHRyaWJ1dGUoXCJmb3JcIiwgXCJkZXNjcmlwdGlvblwiKTtcbiAgaW5wdXREZXNjcmlwdGlvbk5MYWJlbC5hcHBlbmRDaGlsZChsYWJlbCk7XG5cbiAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gIGlucHV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJ0ZXh0XCIpO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJuYW1lXCIsIFwiZGVzY3JpcHRpb25cIik7XG4gIGlucHV0LnNldEF0dHJpYnV0ZShcImlkXCIsIFwiZGVzY3JpcHRpb25cIik7XG4gIGlucHV0RGVzY3JpcHRpb25OTGFiZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuXG4gIGNvbnN0IGlucHV0RHVlRGF0ZU5MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXREdWVEYXRlTkxhYmVsKTtcbiAgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG4gIGxhYmVsLmlubmVySFRNTCA9IFwiRHVlIERhdGU6IFwiO1xuICBsYWJlbC5zZXRBdHRyaWJ1dGUoXCJmb3JcIiwgXCJkdWVEYXRlXCIpO1xuICBpbnB1dER1ZURhdGVOTGFiZWwuYXBwZW5kQ2hpbGQobGFiZWwpO1xuXG4gIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiZGF0ZVwiKTtcbiAgaW5wdXQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBcImR1ZURhdGVcIik7XG4gIGlucHV0LnNldEF0dHJpYnV0ZShcImlkXCIsIFwiZHVlRGF0ZVwiKTtcbiAgaW5wdXREdWVEYXRlTkxhYmVsLmFwcGVuZENoaWxkKGlucHV0KTtcblxuICBjb25zdCBpbnB1dFByaW9yaXR5TkxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgZm9ybS5hcHBlbmRDaGlsZChpbnB1dFByaW9yaXR5TkxhYmVsKTtcbiAgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG4gIGxhYmVsLmlubmVySFRNTCA9IFwiUHJpb3JpdHk6XCI7XG4gIGxhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcInByaW9yaXR5XCIpO1xuICBpbnB1dFByaW9yaXR5TkxhYmVsLmFwcGVuZENoaWxkKGxhYmVsKTtcblxuICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgMzsgaW5kZXggKz0gMSkge1xuICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICAgIGxldCBwcmlvcml0eTtcbiAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIHByaW9yaXR5ID0gXCJsb3dcIjtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgMTpcbiAgICAgICAgcHJpb3JpdHkgPSBcIm1lZGl1bVwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgcHJpb3JpdHkgPSBcInVyZ2VudFwiO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG4gICAgbGFiZWwuc2V0QXR0cmlidXRlKFwiZm9yXCIsIHByaW9yaXR5KTtcbiAgICBsYWJlbC5pbm5lckhUTUwgPSBwcmlvcml0eTtcbiAgICBpbnB1dFByaW9yaXR5TkxhYmVsLmFwcGVuZENoaWxkKGxhYmVsKTtcbiAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwicmFkaW9cIik7XG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBwcmlvcml0eSk7XG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKFwiaWRcIiwgcHJpb3JpdHkpO1xuICAgIGlucHV0UHJpb3JpdHlOTGFiZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuICB9XG5cbiAgY29uc3Qgc3VtYml0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICBmb3JtLmFwcGVuZENoaWxkKHN1bWJpdEJ1dHRvbik7XG4gIHN1bWJpdEJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwic3VibWl0XCIpO1xuICBzdW1iaXRCdXR0b24uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJzdWJtaXRCdXR0b25cIik7XG4gIHJldHVybiBmb3JtO1xufTtcblxuY29uc3QgdG9Eb0NvbGxlY3Rpb24gPSAoKSA9PiB7XG4gIGNvbnN0IHRvRG9MaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b0RvTGlzdFwiKTtcblxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoMlwiKTtcbiAgdGl0bGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJ0ZXh0LWNlbnRlclwiKTtcbiAgdGl0bGUuaW5uZXJIVE1MID0gXCJMaXN0IG9mIFRvRG9cIjtcblxuICB0b0RvTGlzdC5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cbiAgY29uc3QgdG9Eb0xpc3RCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIHRvRG9MaXN0QmxvY2suc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJ0b0RvTGlzdEJsb2NrXCIpO1xuXG4gIHRvRG9MaXN0QmxvY2suYXBwZW5kQ2hpbGQoZm9ybSgpKTtcbiAgdG9Eb0xpc3QuYXBwZW5kQ2hpbGQodG9Eb0xpc3RCbG9jayk7XG5cbiAgY29uc3QgdG9Eb0xpc3RTaG93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgdG9Eb0xpc3RTaG93LnNldEF0dHJpYnV0ZShcImlkXCIsIFwidG9Eb0xpc3RTaG93XCIpO1xuICB0b0RvTGlzdC5hcHBlbmRDaGlsZCh0b0RvTGlzdFNob3cpO1xuICBjb25zdCBjdXJyZW50UHJvamVjdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3VycmVudFByb2plY3RcIik7XG5cbiAgY29uc3QgYXJyYXlBdXggPVxuICAgIGN1cnJlbnRQcm9qZWN0ID09PSBcIkRlZmF1bHRcIlxuICAgICAgPyBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiRGVmYXVsdFwiKSlcbiAgICAgIDogSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShgJHtjdXJyZW50UHJvamVjdH1gKSk7XG4gIGNvbnNvbGUubG9nKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oYCR7Y3VycmVudFByb2plY3R9YCkpKTtcbiAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGFycmF5QXV4Lmxlbmd0aDsgaW5kZXggKz0gMSkge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgVG9EbyhcbiAgICAgIGFycmF5QXV4W2luZGV4XS50aXRsZSxcbiAgICAgIGFycmF5QXV4W2luZGV4XS5kZXNjcmlwdGlvbixcbiAgICAgIGFycmF5QXV4W2luZGV4XS5kYXRlLFxuICAgICAgYXJyYXlBdXhbaW5kZXhdLnByaW9yaXR5LFxuICAgICAgYXJyYXlBdXhbaW5kZXhdLmlkXG4gICAgKTtcbiAgICBpZiAoY2FyZC5pZCkge1xuICAgICAgY29uc3QgcmVuZGVyQ2FyZCA9IGNhcmQucHJpbnQoKTtcbiAgICAgIHRvRG9MaXN0U2hvdy5hcHBlbmRDaGlsZChyZW5kZXJDYXJkKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdG9Eb0xpc3Q7XG59O1xuXG5leHBvcnQgZGVmYXVsdCB0b0RvQ29sbGVjdGlvbjtcbiJdLCJzb3VyY2VSb290IjoiIn0=